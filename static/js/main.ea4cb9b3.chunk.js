(this.webpackJsonproguelike=this.webpackJsonproguelike||[]).push([[0],{20:function(n,t,e){n.exports=e(34)},25:function(n,t,e){},28:function(n,t,e){},33:function(n,t,e){},34:function(n,t,e){"use strict";e.r(t);var r=e(0),i=e.n(r),o=e(14),a=e.n(o),c=(e(25),e(6)),u=e(2),l=e(3),s=e(4);function f(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  position: absolute;\n  z-index: 999;\n  background-color: beige;\n  padding: 2rem;\n\n  h2, button {\n    color: #4135ff;\n  }\n\n  button:hover {\n    background-color: #4135ff;\n    border-color: #4135ff;\n    color: beige\n  }\n\n  h2 {\n    font-size: 3rem;\n    line-height: 3rem;\n    margin: 0rem;\n    margin-bottom: 1rem;\n  }\n"]);return f=function(){return n},n}function h(){var n=Object(l.a)(["\n  ","\n  animation-name: 'shake';\n  flex-direction: column;\n"]);return h=function(){return n},n}function p(){var n=Object(l.a)(["\n  ","\n  ","\n  ","\n  animation-name: ",";\n"]);return p=function(){return n},n}function d(){var n=Object(l.a)(["\n  ","\n"]);return d=function(){return n},n}function v(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return v=function(){return n},n}function b(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  animation-name: grow;\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n"]);return b=function(){return n},n}function y(){var n=Object(l.a)(["\n  @keyframes shake {\n    20% {\n      transform: translate3d(4px, -4px, 0);\n    }\n    40% {\n      transform: translate3d(-4px, 4px, 0);\n    }\n    60% {\n      transform: translate3d(4px, 4px, 0);\n    }\n    80% {\n      transform: translate3d(-4px, -4px, 0);\n    }\n  }\n\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n  animation-timing-function: cubic-bezier(.36,.07,.19,.97);\n"]);return y=function(){return n},n}var m=Object(s.a)(y()),g=Object(s.a)(b()),w=Object(s.a)(v()),x=s.b.div(d(),w),j=s.b.div(p(),m,g,w,(function(n){return n.shake?"shake, grow":void 0})),O=s.b.div(h(),w),E=s.b.div(f());e(28);function k(){var n=Object(l.a)(["\n  width: CELL_SIZE;\n  height: CELL_SIZE;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    border: solid 2px white;\n    cursor: pointer;\n    p {\n      color: white;\n    }\n    background-color: navy;\n    opacity: 1;\n  }\n\n  p {\n    display: inline;\n    margin-block-start: 0.2rem;\n    margin-block-end: 0;\n    font-weight: 700;\n  }\n"]);return k=function(){return n},n}function S(){var n=Object(l.a)(["\n  position: relative;\n  width: 0;\n  height: 0;\n"]);return S=function(){return n},n}var M=function(n){return{"@":"#fffa03","#":"black","+":"beige",">":"yellow","*":"yellow",b:"yellow","\xf3":"yellow",S:"white","\u2752":"white"}[n]||"tomato"},C=function(n){return{"#":"beige","+":"#4135ff",S:"#AAAAFF77","\u2752":"black"}[n]||"transparent"},L=function(n,t){return"\u2752"===t?1:"S"===t?3:n||"b"===t?2:1},A=s.b.div.attrs((function(n){var t=n.x,e=n.y,r=n.solid,i=n.char;return{style:{left:30*t+"px",top:30*e+"px",zIndex:L(r,i),color:M(i)}}}))(S()),I=s.b.div.attrs((function(n){var t=n.char;return{style:{opacity:"\xb7"!==t?"100%":"10%",width:"30px",height:"30px",backgroundColor:C(t)}}}))(k()),z=function(n){if(n.attacking){var t=n.attacking,e=t.x,r=t.y;if(e<0)return"bump-left";if(e>0)return"bump-right";if(r<0)return"bump-up";if(r>0)return"bump-down"}return""},N=function(n,t){return"b"===n&&1===t?"shake":""},P=function(n){var t=n.entity,e=n.hoverStart,r=t.char,o=t.position,a=o.x,c=o.y,u=t.solid,l=t.status,s=t.health;return i.a.createElement(A,{x:a,y:c,solid:u,char:r},i.a.createElement(I,{char:r,className:"".concat(z(l)," ").concat(N(r,s)),onMouseEnter:function(){return e(t)}},i.a.createElement("p",null,function(n,t){return"+"===n?"#":"#"===n?"#":"b"===n?t:"\u2752"===n?"":n}(r,s))))};function B(){var n=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  span {\n    display: inline-block;\n  }\n  .trait {\n    color: yellow;\n    font-weight: 600;\n  }\n"]);return B=function(){return n},n}function q(){var n=Object(l.a)(["\n  justify-content: center;\n  align-content: center;\n  flex-direction: column;\n  display: flex;\n  width: ","px;\n  height: 5rem;\n  p {\n    text-align: center;\n    line-height: 1.5rem;\n    font-size: 1.2rem;\n    color: white;\n    font-weight: 400;\n    margin-top: 0.6rem;\n  }\n"]);return q=function(){return n},n}function G(){var n=Object(l.a)(["\n  width: ","px;\n  height: ","px;\n  font-size: ","rem;\n  margin-bottom: 1rem;\n"]);return G=function(){return n},n}function Y(){var n=Object(l.a)(["\n  flex-direction: column;\n"]);return Y=function(){return n},n}var D,F=s.b.div(Y()),J=s.b.div(G(),(function(n){return n.width}),(function(n){return n.height}),2),T=s.b.div(q(),(function(n){return n.width})),W=s.b.div(B()),Z=function(n){var t=n.hovered;if(!t||!t.stats)return i.a.createElement(W,null,i.a.createElement("p",null));var e=t.stats,r=e.capacity,o=e.power,a=e.radius,c=e.timer,u=function(n){return["","large","plentiful"][n-1]}(r),l=function(n){return[null,"powerful","very powerful","dangerously powerful"][n-1]}(o),s=function(n){return[null,"large radius","very large radius","dangerously large radius"][n-1]}(a),f=function(n){var t=null;return 2===n&&(t="short fuse"),5===n&&(t="long fuse"),t}(c);return i.a.createElement(W,null,i.a.createElement("p",null,i.a.createElement("span",null,"A")," ",u&&i.a.createElement("span",{className:"trait"},u," ")," ",i.a.createElement("span",null,"bomb bag")," ",(l||s||f)&&i.a.createElement("span",null,"with")," ",l&&i.a.createElement("span",{className:"trait"},l," ")," ",s&&i.a.createElement("span",{className:"trait"},s," ")," ",f&&i.a.createElement("span",{className:"trait"},f," ")," ",(l||s||f)&&i.a.createElement("span",null,"bombs")))},_=function(n){var t=n.entities,e=Object(r.useState)({}),o=Object(c.a)(e,2),a=o[0],u=o[1],l=function(n){u(n)},s=a&&a.stats;return i.a.createElement(F,null,i.a.createElement(J,{width:270,height:270,onMouseLeave:function(){u(null)}},t.map((function(n){return i.a.createElement(P,{entity:n,key:n.id,hoverStart:l})}))),i.a.createElement(T,{width:270},!s&&i.a.createElement("p",null,a?a.description:""),s&&i.a.createElement(Z,{hovered:a})))},R=e(5),U=e(18),$={x:0,y:-1},H={x:0,y:1},K={x:-1,y:0},Q={x:1,y:0},V=function(n,t){return{x:n.x+t.x,y:n.y+t.y}},X=function(n,t){return{x:n.x-t.x,y:n.y-t.y}},nn=function(n,t){var e=t.x,r=t.y,i=Object(U.a)(n,[e,r]),o=Object(c.a)(i,2);return{x:o[0],y:o[1]}},tn=function(n){for(var t=Object(R.a)(n),e=t.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),i=[t[r],t[e]];t[e]=i[0],t[r]=i[1]}return t},en=e(7),rn=function(n){return Cn(Object(u.a)({char:"G",solid:!0,behaviours:[dn,mn,gn],name:"Gooblini",description:"Basic enemy, but best not touch it"},n))},on=function(n){return Cn(Object(u.a)({char:"C",solid:!0,behaviours:[vn,dn,gn],name:"Charger",description:"If it sees you, it charges toward you"},n))},an=function(n){return Cn(Object(u.a)({char:"E",solid:!0,behaviours:[wn,bn,gn],name:"Bombeater",description:"Eats bombs, om nom"},n))},cn=function(n){return Cn(Object(u.a)({char:"s",solid:!1,health:5,behaviours:[hn],name:"Ghost spawner",description:"",visible:!1},n))},un=function(n,t){var e=[[rn],[rn,on],[rn,on,an],[rn,on,an],[rn,on,an]][n-1];return e[Math.floor(Math.random()*e.length)](t)},ln=function(n){return"\u2752"!==n.char&&!(!n.solid&&"@"!==n.char)},sn=function(n,t){return Nn(n,t).find(ln)},fn=function(n,t){var e=n.radius,r=n.power;if(n.health-=1,n.health>0)return[];for(var i=[n.position],o=[n.position],a=0,c=[$,H,K,Q];a<c.length;a++){var u=Gn(c[a],n.position,e,t),l=u.findIndex((function(n){return sn(n,t)}));-1!==l?(i.push(u[l]),o.push.apply(o,Object(R.a)(u.slice(0,l+1)))):o.push.apply(o,Object(R.a)(u))}var s=Pn(i,t).map((function(n){return{type:"attack",value:r,target:n,cost:0}})),f=o.map((function(n){return{type:"spawn",value:1,entity:In({position:n}),cost:0}}));return[].concat(Object(R.a)(s),Object(R.a)(f))},hn=function(n,t){if(n.health-=1,n.health>0)return[];var e,r=n.position;return[{type:"spawn",value:1,entity:(e={position:r},Cn(Object(u.a)({char:"S",solid:!1,health:99,speed:"half",behaviours:[yn,gn],name:"Spooky ghost",description:"Oooooo spooky"},e))),cost:0}]},pn=function(n,t){return[{type:"attack",value:1,target:n,cost:0}]},dn=function(n,t){return[{type:"move",direction:n.facing,cost:1}]},vn=function(n,t){for(var e=0,r=[$,H,K,Q];e<r.length;e++){var i=r[e];if(Yn("@",i,n.position,12,t))return[{type:"move",direction:i,cost:1},{type:"face",direction:i,cost:0}]}return[]},bn=function(n,t){for(var e=0,r=[$,H,K,Q];e<r.length;e++){var i=r[e];if(Yn("b",i,n.position,12,t))return[{type:"move",direction:i,cost:1},{type:"face",direction:i,cost:0}]}return[]},yn=function(n,t){var e=Ln(t),r=e.position.x>n.position.x?1:-1,i=e.position.y>n.position.y?1:-1;return[{type:"move",direction:Math.random()>.5?{x:0,y:i}:{x:r,y:0},cost:1,force:!0}]},mn=function(n,t){for(var e=n.facing,r=0,i=[e,nn(-90,e),nn(90,e),nn(180,e)];r<i.length;r++){var o=i[r],a=V(o,n.position);if(Dn(a,t))return[{type:"face",direction:o,cost:0}]}return[]},gn=function(n,t){var e=Nn(n.position,t).find((function(n){return"@"===n.char}));return e?[{type:"attack",value:1,target:e,cost:0}]:[]},wn=function(n,t){var e=qn(n.position),r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var u=a.value,l=Nn(u,t).find((function(n){return"b"===n.char}));if(l)return[{type:"eat",target:l,cost:0},{type:"move",direction:X(u,n.position),cost:1}]}}catch(s){i=!0,o=s}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return[]},xn=function(n,t){var e=Nn(n.position,t),r=e.find((function(n){return">"===n.char})),i=e.find((function(n){return"<"===n.char}));return r?[{type:"change-level",value:1,cost:0}]:i?[{type:"change-level",value:-1,cost:0}]:[]},jn=function(n,t){n.weapon.position=n.position;var e=Nn(n.position,t).find((function(n){return n.use}));return e?(n.weapon=e,Object(en.remove)(t,(function(n){return n.id===e.id})),[]):[]},On=function(n,t,e){return Cn(Object(u.a)({char:"\xf3",solid:!1,health:999,capacity:n.capacity||1,description:"A standard bomb bag",stats:{radius:t.radius,power:t.power,capacity:n.capacity,timer:t.health},use:function(n){return{type:"place-bomb",cost:1,bomb:An(Object(u.a)({},t,{position:n.position}))}}},e))},En=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e={capacity:1,description:"A standard bomb bag"},r={radius:Math.ceil(Math.random()*n),health:3,power:1};return On(e,r,t)},kn=[function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=3*Math.random()+n,r=1;e>4?r=2:e>6&&(r=3);var i={capacity:3},o={radius:2},a={radius:3},c={health:2},l={health:5},s={},f={},h=tn([o,a,c,l]),p=h.slice(0,r),d=!0,v=!1,b=void 0;try{for(var y,m=p[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value;g===i?s=Object(u.a)({},s,{},g):f=Object(u.a)({},f,{},g)}}catch(w){v=!0,b=w}finally{try{d||null==m.return||m.return()}finally{if(v)throw b}}return On(s,f,t)}],Sn=function(){return tn(kn)[0]},Mn=0,Cn=function(n){return n.position||console.error("entity was created without a position",n),n.id&&console.error("Entity should probably not have a custom ID"),Object(u.a)({id:Mn++,char:"?",weapon:null,facing:{x:0,y:1},alive:!0,solid:!1,behaviours:[],actions:[],actionsPerTurn:1,status:{},health:1,description:"",visible:!0},n)},Ln=function(n){return n.find((function(n){return"@"===n.char}))},An=function(n){return Cn(Object(u.a)({char:"b",solid:!0,behaviours:[fn],description:"It's a bomb, and it's going to explode!",health:3,power:1,radius:1},n))},In=function(n){return Cn(Object(u.a)({char:"*",solid:!1,behaviours:[pn],health:1},n))},zn=function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Cn(Object(u.a)({char:t?"+":"#",health:t?1:999,solid:!0,description:"You see a wall. ".concat(t?"":"It seems unbreakable.")},n))},Nn=function(n,t){return t.filter((function(t){return Object(en.isEqual)(t.position,n)}))},Pn=function(n,t){return n.map((function(n){return Nn(n,t)})).flat()},Bn=function(n){var t=n.x,e=n.y;return 0===t||8===t||0===e||8===e},qn=function(n){return[V($,n),V(H,n),V(K,n),V(Q,n)]},Gn=function(n,t,e){for(var r=[];e>0;){var i={x:n.x*e,y:n.y*e},o=V(t,i);r.push(o),e-=1}return r.reverse()},Yn=function(n,t,e,r,i){var o=Gn(t,e,r),a=!0,c=!1,u=void 0;try{for(var l,s=o[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var f=l.value,h=Nn(f,i),p=!0,d=!1,v=void 0;try{for(var b,y=h[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var m=b.value;if(m.char===n)return!0;if(m.solid)return!1}}catch(g){d=!0,v=g}finally{try{p||null==y.return||y.return()}finally{if(d)throw v}}}}catch(g){c=!0,u=g}finally{try{a||null==s.return||s.return()}finally{if(c)throw u}}return!1},Dn=function(n,t){var e=Nn(n,t);return 0===e.length||!e.some((function(n){return n.solid}))},Fn=function(n,t){for(var e=function(n){for(var t=[n],e=[],r=0;r<9;r+=1)for(var i=function(i){var o={x:r,y:i};if(Object(en.isEqual)(o,n.position))return"continue";var a,c=qn(n.position).find((function(n){return Object(en.isEqual)(o,n)}));if(!Bn(o)&&c)return"continue";if(Bn(o)||r%2===0&&i%2===0){var l=zn({position:o},!1);t.push(l)}else{var s=(a={position:o},Cn(Object(u.a)({char:"\xb7",solid:!1},a)));e.push(s)}},o=0;o<9;o+=1)i(o);for(var a,c=tn(e),l=e.length-16,s=Math.min(Math.random()*(l/4)+5,l),f=l-s,h=Math.min(Math.random()*f/2,0),p=0;p<s;p+=1){var d=c.pop().position;t.push(zn({position:d},!0))}for(var v=0;v<h;v+=1){var b=c.pop().position;t.push((a={position:b},Cn(Object(u.a)({char:"\u2752",solid:!0,description:"A hole in the ground",health:999},a))))}return[].concat(t,Object(R.a)(c))}(t),r=e.filter((function(n){return"\xb7"===n.char})),i=tn(r),o=Math.ceil(1.75*n),a=0;a<o;a+=1){var c=i.pop(),l=un(n,{position:c.position});e.push(l)}for(var s=0,f=[{health:75,position:{x:-2,y:-2}},{health:100,position:{x:10,y:-2}},{health:125,position:{x:10,y:10}},{health:150,position:{x:-2,y:10}}];s<f.length;s++){var h=cn(f[s]);e.push(h)}var p=e.filter((function(n){return"+"===n.char})),d=tn(p),v=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";return Cn(Object(u.a)({char:"down"===t?">":"<",health:999,description:"You see a staircase leading down"},n))}({position:d.pop().position});e.push(v);var b=Sn()(n+1,{position:d.pop().position});return e.push(b),e.filter((function(n){return"\xb7"!==n.char}))},Jn=function(n,t){return Fn(n,t)},Tn=0,Wn=function(n,t,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={x:n.position.x+e.x,y:n.position.y+e.y},o=Nn(i,t);return!(!r&&o.filter((function(n){return n.solid})).length>0)&&(n.position=i,!0)},Zn=function(n,t,e){var r=Object(u.a)({},e,{position:n.position,owner:n});t.push(r)},_n=function(n,t,e,r){for(;n.length>0;){var i=n.pop();if(t.actionPoints>=i.cost){if(t.actionPoints-=i.cost,"wait"===i.type&&(t.status.waiting=!0),"eat"===i.type&&(i.target.alive=!1,i.target.solid=!1,r.shake=!0),"attack"===i.type){var o=i.value,a=i.target;a.health-=o,t.status.attacking=X(a.position,t.position),r.shake=!0}if("move"===i.type&&Wn(t,e,i.direction,i.force),"spawn"===i.type){var c=i.entity;e.push(c)}"place-bomb"===i.type&&Zn(t,e,i.bomb),"face"===i.type&&(t.facing=i.direction),"change-level"===i.type&&(r.changeLevel=!0)}}},Rn=function(n,t,e){if("half"!==n.speed||Tn%2!==0){n.status={},n.actionPoints=n.actionsPerTurn,n.prevPosition={x:n.position.x,y:n.position.y},_n(n.actions,n,t,e),n.actions=[];var r=!0,i=!1,o=void 0;try{for(var a,c=n.behaviours[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var u=(0,a.value)(n,t).reverse();_n(u,n,t,e)}}catch(l){i=!0,o=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}}},Un=(e(33),D={position:{x:1,y:1}},Cn(Object(u.a)({char:"@",solid:!1,health:1,behaviours:[xn,jn],description:"It's you, the player",weapon:En(1)},D))),$n=Jn(1,Object(u.a)({},Un));var Hn=function(){var n=Object(r.useState)(1),t=Object(c.a)(n,2),e=t[0],o=t[1],a=Object(r.useState)($n),l=Object(c.a)(a,2),s=l[0],f=l[1],h=Object(r.useState)({}),p=Object(c.a)(h,2),d=p[0],v=p[1],b=!Ln(s),y=e>5,m=function(){o(1),f(Jn(1,Object(u.a)({},Un)))},g=Object(r.useCallback)((function(){o(0),f(Jn(e,Object(u.a)({},Un)))}),[e]),w=Object(r.useCallback)((function(n){o(e+1),e<5&&f(Jn(e+1,n))}),[e]),k=Object(r.useCallback)((function(n){var t=Ln(s),r=n.key,i=function(n){return{ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}}[n]}(r),o="z"===r.toLowerCase(),a="x"===r.toLowerCase(),c="r"===r.toLowerCase();if(0!==e||!a&&!o)if(!y&&!b||!a&&!o){if(t){if(i&&Wn(t,s,i),a)if(s.filter((function(n){return"b"===n.char&&"@"===n.owner.char})).length<t.weapon.capacity){var u=t.weapon.use(t);t.actions.push(u)}if(i||o||a){var l=function(n){for(var t={},e=Ln(n),r=n.filter((function(n){return n.id!==e.id})),i=0,o=[e].concat(Object(R.a)(r));i<o.length;i++){var a=o[i];Rn(a,n,t)}var c=!0,u=!1,l=void 0;try{for(var s,f=n[Symbol.iterator]();!(c=(s=f.next()).done);c=!0){var h=s.value;h.health<=0&&(h.alive=!1)}}catch(d){u=!0,l=d}finally{try{c||null==f.return||f.return()}finally{if(u)throw l}}var p=n.filter((function(n){return n.alive}));return Tn++,{newEntities:p,newEvents:t}}(s),h=l.newEntities,p=l.newEvents;f(h),v(p),p.changeLevel&&w(t)}c&&m()}}else g();else m()}),[s,w,g,e,b,y]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",k),function(){window.removeEventListener("keydown",k)}}),[k]),i.a.createElement(x,null,0===e?i.a.createElement(O,null,i.a.createElement("h1",null,"bomblike"),i.a.createElement("button",{onClick:m},"play")):i.a.createElement(j,{className:"map-container",shake:!0===d.shake},(y||b)&&i.a.createElement(E,null,i.a.createElement("h2",null,y?"Success!":"You died"),i.a.createElement("button",{onClick:g},"Back to title")),i.a.createElement(_,{entities:s.filter((function(n){return n.visible}))})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(Hn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.ea4cb9b3.chunk.js.map