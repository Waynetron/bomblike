(this.webpackJsonproguelike=this.webpackJsonproguelike||[]).push([[0],{20:function(n,t,e){n.exports=e(34)},25:function(n,t,e){},28:function(n,t,e){},33:function(n,t,e){},34:function(n,t,e){"use strict";e.r(t);var r=e(0),o=e.n(r),i=e(14),a=e.n(i),c=(e(25),e(6)),u=e(2),l=e(3),s=e(4);function f(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  position: absolute;\n  z-index: 999;\n  background-color: beige;\n  padding: 2rem;\n\n  h2, button {\n    color: #4135ff;\n  }\n\n  button:hover {\n    background-color: #4135ff;\n    border-color: #4135ff;\n    color: beige\n  }\n\n  h2 {\n    font-size: 3rem;\n    line-height: 3rem;\n    margin: 0rem;\n    margin-bottom: 1rem;\n  }\n"]);return f=function(){return n},n}function p(){var n=Object(l.a)(["\n  ","\n  animation-name: 'shake';\n  flex-direction: column;\n"]);return p=function(){return n},n}function h(){var n=Object(l.a)(["\n  ","\n  ","\n  ","\n  animation-name: ",";\n"]);return h=function(){return n},n}function d(){var n=Object(l.a)(["\n  ","\n"]);return d=function(){return n},n}function v(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return v=function(){return n},n}function b(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  animation-name: grow;\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n"]);return b=function(){return n},n}function y(){var n=Object(l.a)(["\n  @keyframes shake {\n    20% {\n      transform: translate3d(4px, -4px, 0);\n    }\n    40% {\n      transform: translate3d(-4px, 4px, 0);\n    }\n    60% {\n      transform: translate3d(4px, 4px, 0);\n    }\n    80% {\n      transform: translate3d(-4px, -4px, 0);\n    }\n  }\n\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n  animation-timing-function: cubic-bezier(.36,.07,.19,.97);\n"]);return y=function(){return n},n}var m=Object(s.a)(y()),g=Object(s.a)(b()),w=Object(s.a)(v()),x=s.b.div(d(),w),j=s.b.div(h(),m,g,w,(function(n){return n.shake?"shake, grow":void 0})),O=s.b.div(p(),w),E=s.b.div(f());e(28);function k(){var n=Object(l.a)(["\n  width: CELL_SIZE;\n  height: CELL_SIZE;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    border: solid 2px white;\n    cursor: pointer;\n    p {\n      color: white;\n    }\n    background-color: navy;\n    opacity: 1;\n  }\n\n  p {\n    display: inline;\n    margin-block-start: 0.2rem;\n    margin-block-end: 0;\n    font-weight: 700;\n  }\n"]);return k=function(){return n},n}function S(){var n=Object(l.a)(["\n  position: relative;\n  width: 0;\n  height: 0;\n"]);return S=function(){return n},n}var M=function(n){return{"@":"#fffa03","#":"black","+":"beige",">":"yellow","*":"yellow",b:"yellow","\xf3":"yellow",S:"white"}[n]||"tomato"},C=function(n){return{"#":"beige","+":"#4135ff",S:"#AAAAFF77"}[n]||"transparent"},L=function(n,t){return"S"===t?3:n?2:1},A=s.b.div.attrs((function(n){var t=n.x,e=n.y,r=n.solid,o=n.char;return{style:{left:30*t+"px",top:30*e+"px",zIndex:L(r,o),color:M(o)}}}))(S()),I=s.b.div.attrs((function(n){var t=n.char;return{style:{opacity:"\xb7"!==t?"100%":"10%",width:"30px",height:"30px",backgroundColor:C(t)}}}))(k()),z=function(n){if(n.attacking){var t=n.attacking,e=t.x,r=t.y;if(e<0)return"bump-left";if(e>0)return"bump-right";if(r<0)return"bump-up";if(r>0)return"bump-down"}return""},N=function(n,t){return"b"===n&&1===t?"shake":""},P=function(n){var t=n.entity,e=n.hoverStart,r=t.char,i=t.position,a=i.x,c=i.y,u=t.solid,l=t.status,s=t.health;return o.a.createElement(A,{x:a,y:c,solid:u,char:r},o.a.createElement(I,{char:r,className:"".concat(z(l)," ").concat(N(r,s)),onMouseEnter:function(){return e(t)}},o.a.createElement("p",null,function(n,t){return"+"===n?"#":"#"===n?"#":"b"===n?t:n}(r,s))))};function B(){var n=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  span {\n    display: inline-block;\n  }\n  .trait {\n    color: yellow;\n    font-weight: 600;\n  }\n"]);return B=function(){return n},n}function Y(){var n=Object(l.a)(["\n  justify-content: center;\n  align-content: center;\n  flex-direction: column;\n  display: flex;\n  width: ","px;\n  height: 5rem;\n  p {\n    text-align: center;\n    line-height: 1.5rem;\n    font-size: 1.2rem;\n    color: white;\n    font-weight: 400;\n    margin-top: 0.6rem;\n  }\n"]);return Y=function(){return n},n}function q(){var n=Object(l.a)(["\n  width: ","px;\n  height: ","px;\n  font-size: ","rem;\n  margin-bottom: 1rem;\n"]);return q=function(){return n},n}function D(){var n=Object(l.a)(["\n  flex-direction: column;\n"]);return D=function(){return n},n}var F,G=s.b.div(D()),J=s.b.div(q(),(function(n){return n.width}),(function(n){return n.height}),2),T=s.b.div(Y(),(function(n){return n.width})),W=s.b.div(B()),Z=function(n){var t=n.hovered;if(!t||!t.stats)return o.a.createElement(W,null,o.a.createElement("p",null));var e=t.stats,r=e.capacity,i=e.power,a=e.radius,c=e.timer,u=function(n){console.log(n);return["","large","plentiful"][n-1]}(r),l=function(n){return[null,"powerful","very powerful","dangerously powerful"][n-1]}(i),s=function(n){return[null,"large radius","very large radius","dangerously large radius"][n-1]}(a),f=function(n){var t=null;return 2===n&&(t="short fuse"),5===n&&(t="long fuse"),t}(c);return o.a.createElement(W,null,o.a.createElement("p",null,o.a.createElement("span",null,"A")," ",u&&o.a.createElement("span",{className:"trait"},u," ")," ",o.a.createElement("span",null,"bomb bag")," ",(l||s||f)&&o.a.createElement("span",null,"with")," ",l&&o.a.createElement("span",{className:"trait"},l," ")," ",s&&o.a.createElement("span",{className:"trait"},s," ")," ",f&&o.a.createElement("span",{className:"trait"},f," ")," ",(l||s||f)&&o.a.createElement("span",null,"bombs")))},_=function(n){var t=n.entities,e=Object(r.useState)({}),i=Object(c.a)(e,2),a=i[0],u=i[1],l=function(n){u(n)},s=a&&a.stats;return o.a.createElement(G,null,o.a.createElement(J,{width:390,height:390,onMouseLeave:function(){u(null)}},t.map((function(n){return o.a.createElement(P,{entity:n,key:n.id,hoverStart:l})}))),o.a.createElement(T,{width:390},!s&&o.a.createElement("p",null,a?a.description:""),s&&o.a.createElement(Z,{hovered:a})))},R=e(5),U=e(18),$={x:0,y:-1},H={x:0,y:1},K={x:-1,y:0},Q={x:1,y:0},V=function(n,t){return{x:n.x+t.x,y:n.y+t.y}},X=function(n,t){return{x:n.x-t.x,y:n.y-t.y}},nn=function(n,t){var e=t.x,r=t.y,o=Object(U.a)(n,[e,r]),i=Object(c.a)(o,2);return{x:i[0],y:i[1]}},tn=function(n){for(var t=Object(R.a)(n),e=t.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),o=[t[r],t[e]];t[e]=o[0],t[r]=o[1]}return t},en=e(7),rn=function(n,t){var e=n.radius,r=n.power;if(n.health-=1,n.health>0)return[];var o=[].concat(Object(R.a)(Cn($,n.position,e,t)),Object(R.a)(Cn(H,n.position,e,t)),Object(R.a)(Cn(K,n.position,e,t)),Object(R.a)(Cn(Q,n.position,e,t)),[n.position]),i=kn(o,t).map((function(n){return{type:"attack",value:r,target:n,cost:0}})),a=o.map((function(n){return{type:"spawn",value:1,entity:jn({position:n}),cost:0}}));return[].concat(Object(R.a)(i),Object(R.a)(a))},on=function(n,t){return[{type:"attack",value:1,target:n,cost:0}]},an=function(n,t){return[{type:"move",direction:n.facing,cost:1}]},cn=function(n,t){for(var e=0,r=[$,H,K,Q];e<r.length;e++){var o=r[e];if(Ln("@",o,n.position,12,t))return[{type:"move",direction:o,cost:1},{type:"face",direction:o,cost:0}]}return[]},un=function(n,t){for(var e=0,r=[$,H,K,Q];e<r.length;e++){var o=r[e];if(Ln("b",o,n.position,12,t))return[{type:"move",direction:o,cost:1},{type:"face",direction:o,cost:0}]}return[]},ln=function(n,t){var e=wn(t),r=e.position.x>n.position.x?1:-1,o=e.position.y>n.position.y?1:-1;return[{type:"move",direction:Math.random()>.5?{x:0,y:o}:{x:r,y:0},cost:1,force:!0}]},sn=function(n,t){for(var e=n.facing,r=0,o=[e,nn(-90,e),nn(90,e),nn(180,e)];r<o.length;r++){var i=o[r],a=V(i,n.position);if(An(a,t))return[{type:"face",direction:i,cost:0}]}return[]},fn=function(n,t){var e=En(n.position,t).find((function(n){return"@"===n.char}));return e?[{type:"attack",value:1,target:e,cost:0}]:[]},pn=function(n,t){var e=Mn(n.position),r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var u=a.value,l=En(u,t).find((function(n){return"b"===n.char}));if(l)return[{type:"eat",target:l,cost:0},{type:"move",direction:X(u,n.position),cost:1}]}}catch(s){o=!0,i=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return[]},hn=function(n,t){var e=En(n.position,t),r=e.find((function(n){return">"===n.char})),o=e.find((function(n){return"<"===n.char}));return r?[{type:"change-level",value:1,cost:0}]:o?[{type:"change-level",value:-1,cost:0}]:[]},dn=function(n,t){n.weapon.position=n.position;var e=En(n.position,t).find((function(n){return n.use}));return e?(n.weapon=e,Object(en.remove)(t,(function(n){return n.id===e.id})),[]):[]},vn=function(n,t,e){return gn(Object(u.a)({char:"\xf3",solid:!1,health:999,capacity:n.capacity||1,description:"A standard bomb bag",stats:{radius:t.radius,power:t.power,capacity:n.capacity,timer:t.health},use:function(n){return{type:"place-bomb",cost:1,bomb:xn(Object(u.a)({},t,{position:n.position}))}}},e))},bn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e={capacity:Math.max(Math.ceil(Math.random()*n*.75),3),description:"A standard bomb bag"},r={radius:Math.ceil(Math.random()*n),health:3,power:1};return vn(e,r,t)},yn=[function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=3*Math.random()+n,r=1;e>4?r=2:e>6&&(r=3);var o={capacity:3},i={radius:2},a={radius:3},c={health:2},l={health:5},s={power:2},f={},p={},h=tn([o,i,a,c,l,s]),d=h.slice(0,r),v=!0,b=!1,y=void 0;try{for(var m,g=d[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var w=m.value;w===o?f=Object(u.a)({},f,{},w):p=Object(u.a)({},p,{},w)}}catch(x){b=!0,y=x}finally{try{v||null==g.return||g.return()}finally{if(b)throw y}}return vn(f,p,t)}],mn=0,gn=function(n){return n.position||console.error("entity was created without a position",n),n.id&&console.error("Entity should probably not have a custom ID"),Object(u.a)({id:mn++,char:"?",weapon:null,facing:{x:0,y:1},alive:!0,solid:!1,behaviours:[],actions:[],actionsPerTurn:1,status:{},health:1,description:""},n)},wn=function(n){return n.find((function(n){return"@"===n.char}))},xn=function(n){return gn(Object(u.a)({char:"b",solid:!0,behaviours:[rn],description:"You see a bomb. It is set to go off",health:3,power:1,radius:1,speed:"full"},n))},jn=function(n){return gn(Object(u.a)({char:"*",solid:!1,behaviours:[on],health:1},n))},On=function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return gn(Object(u.a)({char:t?"+":"#",health:t?1:999,solid:!0,description:"You see a wall. ".concat(t?"":"It seems unbreakable.")},n))},En=function(n,t){return t.filter((function(t){return Object(en.isEqual)(t.position,n)}))},kn=function(n,t){return n.map((function(n){return En(n,t)})).flat()},Sn=function(n){var t=n.x,e=n.y;return 0===t||12===t||0===e||12===e},Mn=function(n){return[V($,n),V(H,n),V(K,n),V(Q,n)]},Cn=function(n,t,e){for(var r=[];e>0;){var o={x:n.x*e,y:n.y*e},i=V(t,o);r.push(i),e-=1}return r},Ln=function(n,t,e,r,o){var i=Cn(t,e,r),a=!0,c=!1,u=void 0;try{for(var l,s=i.reverse()[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var f=l.value,p=En(f,o),h=!0,d=!1,v=void 0;try{for(var b,y=p[Symbol.iterator]();!(h=(b=y.next()).done);h=!0){var m=b.value;if(m.char===n)return!0;if(m.solid)return!1}}catch(g){d=!0,v=g}finally{try{h||null==y.return||y.return()}finally{if(d)throw v}}}}catch(g){c=!0,u=g}finally{try{a||null==s.return||s.return()}finally{if(c)throw u}}return!1},An=function(n,t){var e=En(n,t);return 0===e.length||!e.some((function(n){return n.solid}))},In=function(n){return gn(Object(u.a)({char:"G",solid:!0,behaviours:[an,sn,fn],name:"Gooblini",description:"Basic enemy, but best not touch it"},n))},zn=function(n){return gn(Object(u.a)({char:"C",solid:!0,behaviours:[cn,an,fn],name:"Charger",description:"If it sees you, it charges toward you"},n))},Nn=function(n){return gn(Object(u.a)({char:"E",solid:!0,behaviours:[pn,un,fn],name:"Bombeater",description:"Eats bombs, om nom"},n))},Pn=function(n,t){var e=[[In],[In,zn],[In,zn,Nn],[In,zn,Nn],[In,zn,Nn]][n-1];return e[Math.floor(Math.random()*e.length)](t)},Bn=function(n,t){for(var e=function(n){for(var t=[n],e=0;e<13;e+=1)for(var r=function(r){var o={x:e,y:r};if(Object(en.isEqual)(o,n.position))return"continue";var i,a=Mn(n.position).find((function(n){return Object(en.isEqual)(o,n)}));if(!Sn(o)&&a)return"continue";if(Sn(o)||e%2===0&&r%2===0){var c=On({position:o},!1);t.push(c)}else if(Math.random()>.8){var l=On({position:o},!0);t.push(l)}else{var s=(i={position:o},gn(Object(u.a)({char:"\xb7",solid:!1},i)));t.push(s)}},o=0;o<13;o+=1)r(o);return t}(t),r=e.filter((function(n){return"\xb7"===n.char})),o=tn(r),i=Math.ceil(1.75*n),a=0;a<i;a+=1){var c=o.pop(),l=Pn(n,{position:c.position});e.push(l)}var s=e.filter((function(n){return"+"===n.char})),f=tn(s),p=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";return gn(Object(u.a)({char:"down"===t?">":"<",health:999,description:"You see a staircase leading down"},n))}({position:f.pop().position});e.push(p);for(var h=0;h<2;h+=1){var d=(0,tn(yn)[0])(n+1,{position:f.pop().position});e.push(d)}return e},Yn=0,qn=function(n,t,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={x:n.position.x+e.x,y:n.position.y+e.y},i=En(o,t);return!(!r&&i.filter((function(n){return n.solid})).length>0)&&(n.position=o,!0)},Dn=function(n,t,e){var r=Object(u.a)({},e,{position:n.position,owner:n});t.push(r)},Fn=function(n,t,e,r){for(;n.length>0;){var o=n.pop();if(t.actionPoints>=o.cost){if(t.actionPoints-=o.cost,"wait"===o.type&&(t.status.waiting=!0),"eat"===o.type&&(o.target.alive=!1,o.target.solid=!1,r.shake=!0),"attack"===o.type){var i=o.value,a=o.target;a.health-=i,t.status.attacking=X(a.position,t.position),r.shake=!0}if("move"===o.type&&qn(t,e,o.direction,o.force),"spawn"===o.type){var c=o.entity;e.push(c)}"place-bomb"===o.type&&Dn(t,e,o.bomb),"face"===o.type&&(t.facing=o.direction),"change-level"===o.type&&(r.changeLevel=!0)}}},Gn=function(n,t,e){if("half"!==n.speed||Yn%2!==0){n.status={},n.actionPoints=n.actionsPerTurn,n.prevPosition={x:n.position.x,y:n.position.y},Fn(n.actions,n,t,e),n.actions=[];var r=!0,o=!1,i=void 0;try{for(var a,c=n.behaviours[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var u=(0,a.value)(n,t).reverse();Fn(u,n,t,e)}}catch(l){o=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}}},Jn=function(n){for(var t={},e=wn(n),r=n.filter((function(n){return n.id!==e.id})),o=0,i=[e].concat(Object(R.a)(r));o<i.length;o++){var a=i[o];Gn(a,n,t)}var c=!0,l=!1,s=void 0;try{for(var f,p=n[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var h=f.value;h.health<=0&&(h.alive=!1)}}catch(y){l=!0,s=y}finally{try{c||null==p.return||p.return()}finally{if(l)throw s}}var d,v=n.filter((function(n){return n.alive}));if(++Yn%100===0){var b=(d={position:{x:-3,y:-3}},gn(Object(u.a)({char:"S",solid:!1,health:99,speed:"half",behaviours:[ln,fn],name:"Spooky ghost",description:"Oooooo spooky"},d)));v.push(b)}return{newEntities:v,newEvents:t}},Tn=(e(33),F={position:{x:1,y:1}},gn(Object(u.a)({char:"@",solid:!1,health:1,behaviours:[hn,dn],description:"It's you, the player",weapon:bn(1)},F))),Wn=Bn(1,Object(u.a)({},Tn));var Zn=function(){var n=Object(r.useState)(1),t=Object(c.a)(n,2),e=t[0],i=t[1],a=Object(r.useState)(Wn),l=Object(c.a)(a,2),s=l[0],f=l[1],p=Object(r.useState)({}),h=Object(c.a)(p,2),d=h[0],v=h[1],b=!wn(s),y=e>5,m=function(){i(1),f(Bn(1,Object(u.a)({},Tn)))},g=Object(r.useCallback)((function(){i(0),f(Bn(e,Object(u.a)({},Tn)))}),[e]),w=Object(r.useCallback)((function(n){i(e+1),e<5&&f(Bn(e+1,n))}),[e]),k=Object(r.useCallback)((function(n){var t=wn(s),r=n.key,o=function(n){return{ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}}[n]}(r),i="z"===r.toLowerCase(),a="x"===r.toLowerCase(),c="r"===r.toLowerCase();if(0!==e||!a&&!i)if(!y&&!b||!a&&!i){if(t){if(o&&qn(t,s,o),a)if(s.filter((function(n){return"b"===n.char&&"@"===n.owner.char})).length<t.weapon.capacity){var u=t.weapon.use(t);t.actions.push(u)}if(o||i||a){var l=Jn(s),p=l.newEntities,h=l.newEvents;f(p),v(h),h.changeLevel&&w(t)}c&&m()}}else g();else m()}),[s,w,g,e,b,y]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",k),function(){window.removeEventListener("keydown",k)}}),[k]),o.a.createElement(x,null,0===e?o.a.createElement(O,null,o.a.createElement("h1",null,"bomblike"),o.a.createElement("button",{onClick:m},"play")):o.a.createElement(j,{className:"map-container",shake:!0===d.shake},(y||b)&&o.a.createElement(E,null,o.a.createElement("h2",null,y?"Success!":"You died"),o.a.createElement("button",{onClick:g},"Back to title")),o.a.createElement(_,{entities:s})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(Zn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.f6a52abe.chunk.js.map