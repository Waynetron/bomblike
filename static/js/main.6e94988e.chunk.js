(this.webpackJsonproguelike=this.webpackJsonproguelike||[]).push([[0],{15:function(n,t,e){n.exports=e(27)},20:function(n,t,e){},23:function(n,t,e){},26:function(n,t,e){},27:function(n,t,e){"use strict";e.r(t);var r=e(0),i=e.n(r),a=e(10),o=e.n(a),c=(e(20),e(5)),u=e(1),l=e(2),s=e(3);function f(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  position: absolute;\n  z-index: 999;\n  background-color: beige;\n  padding: 2rem;\n\n  h2, button {\n    color: #4135ff;\n  }\n\n  button:hover {\n    background-color: #4135ff;\n    border-color: #4135ff;\n    color: beige\n  }\n\n  h2 {\n    font-size: 3rem;\n    line-height: 3rem;\n    margin: 0rem;\n    margin-bottom: 1rem;\n  }\n"]);return f=function(){return n},n}function p(){var n=Object(l.a)(["\n  ","\n  animation-name: 'shake';\n  flex-direction: column;\n"]);return p=function(){return n},n}function h(){var n=Object(l.a)(["\n  ","\n  ","\n  ","\n  animation-name: ",";\n"]);return h=function(){return n},n}function d(){var n=Object(l.a)(["\n  ","\n"]);return d=function(){return n},n}function b(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return b=function(){return n},n}function v(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  animation-name: grow;\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n"]);return v=function(){return n},n}function m(){var n=Object(l.a)(["\n  @keyframes shake {\n    20% {\n      transform: translate3d(4px, -4px, 0);\n    }\n    40% {\n      transform: translate3d(-4px, 4px, 0);\n    }\n    60% {\n      transform: translate3d(4px, 4px, 0);\n    }\n    80% {\n      transform: translate3d(-4px, -4px, 0);\n    }\n  }\n\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n  animation-timing-function: cubic-bezier(.36,.07,.19,.97);\n"]);return m=function(){return n},n}var y=Object(s.a)(m()),g=Object(s.a)(v()),w=Object(s.a)(b()),x=s.b.div(d(),w),j=s.b.div(h(),y,g,w,(function(n){return n.shake?"shake, grow":void 0})),O=s.b.div(p(),w),E=s.b.div(f());e(23);function k(){var n=Object(l.a)(["\n  width: CELL_SIZE;\n  height: CELL_SIZE;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    border: solid 2px white;\n    cursor: pointer;\n    p {\n      color: white;\n    }\n    background-color: navy;\n    opacity: 1;\n  }\n\n  p {\n    display: inline;\n    margin-block-start: 0.2rem;\n    margin-block-end: 0;\n    font-weight: 700;\n  }\n"]);return k=function(){return n},n}function L(){var n=Object(l.a)(["\n  position: relative;\n  width: 0;\n  height: 0;\n"]);return L=function(){return n},n}var M=function(n){return{"@":"#fffa03","#":"black","+":"beige",">":"yellow","*":"yellow",b:"yellow",G:"#4135ff","\xf3":"yellow"}[n]||"white"},C=function(n){return{"#":"beige","+":"#4135ff"}[n]||"transparent"},S=s.b.div.attrs((function(n){var t=n.x,e=n.y,r=n.solid,i=n.char;return{style:{left:30*t+"px",top:30*e+"px",zIndex:r?2:1,color:M(i)}}}))(L()),z=s.b.div.attrs((function(n){var t=n.char;return{style:{opacity:"\xb7"!==t?"100%":"10%",width:"30px",height:"30px",backgroundColor:C(t)}}}))(k()),I=function(n){if(n.attacking){var t=n.attacking,e=t.x,r=t.y;if(e<0)return"bump-left";if(e>0)return"bump-right";if(r<0)return"bump-up";if(r>0)return"bump-down"}return""},A=function(n,t){return"b"===n&&1===t?"shake":""},N=function(n){var t=n.entity,e=n.hoverStart,r=t.char,a=t.position,o=a.x,c=a.y,u=t.solid,l=t.status,s=t.health;return i.a.createElement(S,{x:o,y:c,solid:u,char:r},i.a.createElement(z,{char:r,className:"".concat(I(l)," ").concat(A(r,s)),onMouseEnter:function(){return e(t)}},i.a.createElement("p",null,function(n,t){return"+"===n?"#":"#"===n?"#":"b"===n?t:n}(r,s))))};function P(){var n=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  span {\n    display: inline-block;\n  }\n  .trait {\n    color: yellow;\n    font-weight: 600;\n  }\n"]);return P=function(){return n},n}function Y(){var n=Object(l.a)(["\n  justify-content: center;\n  align-content: center;\n  flex-direction: column;\n  display: flex;\n  width: ","px;\n  height: 5rem;\n  p {\n    text-align: center;\n    line-height: 1.5rem;\n    font-size: 1.2rem;\n    color: white;\n    font-weight: 400;\n    margin-top: 0.6rem;\n  }\n"]);return Y=function(){return n},n}function q(){var n=Object(l.a)(["\n  width: ","px;\n  height: ","px;\n  font-size: ","rem;\n  margin-bottom: 1rem;\n"]);return q=function(){return n},n}function B(){var n=Object(l.a)(["\n  flex-direction: column;\n"]);return B=function(){return n},n}var D,G=s.b.div(B()),J=s.b.div(q(),(function(n){return n.width}),(function(n){return n.height}),2),T=s.b.div(Y(),(function(n){return n.width})),W=s.b.div(P()),Z=function(n){var t=n.hovered;if(!t||!t.stats)return i.a.createElement(W,null,i.a.createElement("p",null));var e=t.stats,r=e.capacity,a=e.power,o=e.radius,c=e.timer,u=function(n){console.log(n);return["","large","plentiful"][n-1]}(r),l=function(n){return[null,"powerful","very powerful","dangerously powerful"][n-1]}(a),s=function(n){return[null,"large radius","very large radius","dangerously large radius"][n-1]}(o),f=function(n){var t=null;return 2===n&&(t="short fuse"),5===n&&(t="long fuse"),t}(c);return i.a.createElement(W,null,i.a.createElement("p",null,i.a.createElement("span",null,"A")," ",u&&i.a.createElement("span",{className:"trait"},u," ")," ",i.a.createElement("span",null,"bomb bag")," ",(l||s||f)&&i.a.createElement("span",null,"with")," ",l&&i.a.createElement("span",{className:"trait"},l," ")," ",s&&i.a.createElement("span",{className:"trait"},s," ")," ",f&&i.a.createElement("span",{className:"trait"},f," ")," ",(l||s||f)&&i.a.createElement("span",null,"bombs")))},_=function(n){var t=n.entities,e=Object(r.useState)({}),a=Object(c.a)(e,2),o=a[0],u=a[1],l=function(n){u(n)},s=o&&o.stats;return i.a.createElement(G,null,i.a.createElement(J,{width:390,height:390,onMouseLeave:function(){u(null)}},t.map((function(n){return i.a.createElement(N,{entity:n,key:n.id,hoverStart:l})}))),i.a.createElement(T,{width:390},!s&&i.a.createElement("p",null,o?o.description:""),s&&i.a.createElement(Z,{hovered:o})))},R=e(4),U={x:0,y:-1},$={x:0,y:1},F={x:-1,y:0},H={x:1,y:0},K=function(n,t){return{x:n.x+t.x,y:n.y+t.y}},Q=function(n,t){return{x:n.x-t.x,y:n.y-t.y}},V=function(n){for(var t=Object(R.a)(n),e=t.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),i=[t[r],t[e]];t[e]=i[0],t[r]=i[1]}return t},X=e(6),nn=function(n,t){return t.filter((function(t){return Object(X.isEqual)(t.position,n)}))},tn=function(n,t){return n.map((function(n){return nn(n,t)})).flat()},en=function(n){var t=n.x,e=n.y;return 0===t||12===t||0===e||12===e},rn=function(n){return[K(U,n),K($,n),K(F,n),K(H,n)]},an=function(n,t,e,r){for(var i=[];e>0;){var a={x:n.x*e,y:n.y*e},o=K(t,a);i.push(o),e-=1}return i},on=function(n,t){var e=nn(n,t);return 0===e.length||!e.some((function(n){return n.solid}))},cn=function(n,t){var e=n.radius,r=n.power;if(n.health-=1,n.health>0)return[];var i=[].concat(Object(R.a)(an(U,n.position,e)),Object(R.a)(an($,n.position,e)),Object(R.a)(an(F,n.position,e)),Object(R.a)(an(H,n.position,e)),[n.position]),a=tn(i,t).map((function(n){return{type:"attack",value:r,target:n,cost:0}})),o=i.map((function(n){return{type:"spawn",value:1,entity:xn({position:n}),cost:0}}));return[].concat(Object(R.a)(a),Object(R.a)(o))},un=function(n,t){return[{type:"attack",value:1,target:n,cost:0}]},ln=function(n,t){return[{type:"move",direction:n.facing,cost:1}]},sn=function(n,t){var e=n.facing,r=K(n.position,e);if(on(r,t))return[];var i=rn(n.position).filter((function(n){return on(n,t)}));if(0===i.length)return[];var a=V(i),o=Object(c.a)(a,1)[0];return[{type:"face",direction:Q(o,n.position),cost:0}]},fn=function(n,t){var e=nn(n.position,t).find((function(n){return"@"===n.char}));return e?[{type:"attack",value:1,target:e,cost:0}]:[]},pn=function(n,t){var e=nn(n.position,t),r=e.find((function(n){return">"===n.char})),i=e.find((function(n){return"<"===n.char}));return r?[{type:"change-level",value:1,cost:0}]:i?[{type:"change-level",value:-1,cost:0}]:[]},hn=function(n,t){n.weapon.position=n.position;var e=nn(n.position,t).find((function(n){return n.use}));return e?(n.weapon=e,Object(X.remove)(t,(function(n){return n.id===e.id})),[]):[]},dn=function(n,t,e){return yn(Object(u.a)({char:"\xf3",solid:!1,health:999,capacity:n.capacity||1,description:"A standard bomb bag",stats:{radius:t.radius,power:t.power,capacity:n.capacity,timer:t.health},use:function(n){return{type:"place-bomb",cost:1,bomb:wn(Object(u.a)({},t,{position:n.position}))}}},e))},bn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e={capacity:Math.max(Math.ceil(Math.random()*n*.75),3),description:"A standard bomb bag"},r={radius:Math.ceil(Math.random()*n),health:3,power:1};return dn(e,r,t)},vn=[function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=3*Math.random()+n,r=1;e>4?r=2:e>6&&(r=3);var i={capacity:3},a={radius:2},o={radius:3},c={health:2},l={health:5},s={power:2},f={},p={},h=V([i,a,o,c,l,s]),d=h.slice(0,r),b=!0,v=!1,m=void 0;try{for(var y,g=d[Symbol.iterator]();!(b=(y=g.next()).done);b=!0){var w=y.value;w===i?f=Object(u.a)({},f,{},w):p=Object(u.a)({},p,{},w)}}catch(x){v=!0,m=x}finally{try{b||null==g.return||g.return()}finally{if(v)throw m}}return dn(f,p,t)}],mn=0,yn=function(n){return n.position||console.error("entity was created without a position",n),n.id&&console.error("Entity should probably not have a custom ID"),Object(u.a)({id:mn++,char:"?",weapon:null,facing:{x:0,y:0},alive:!0,solid:!1,behaviours:[],actions:[],actionsPerTurn:1,status:{},health:1,description:""},n)},gn=function(n){return n.find((function(n){return"@"===n.char}))},wn=function(n){return yn(Object(u.a)({char:"b",solid:!0,behaviours:[cn],description:"You see a bomb. It is set to go off",health:3,power:1,radius:1},n))},xn=function(n){return yn(Object(u.a)({char:"*",solid:!1,behaviours:[un],health:1},n))},jn=function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return yn(Object(u.a)({char:t?"+":"#",health:t?1:999,solid:!0,description:"You see a wall. ".concat(t?"":"It seems unbreakable.")},n))},On=function(n,t){for(var e,r=function(n){for(var t=[n],e=0;e<13;e+=1)for(var r=function(r){var i={x:e,y:r};if(Object(X.isEqual)(i,n.position))return"continue";var a,o=rn(n.position).find((function(n){return Object(X.isEqual)(i,n)}));if(!en(i)&&o)return"continue";if(en(i)||e%2===0&&r%2===0){var c=jn({position:i},!1);t.push(c)}else if(Math.random()>.8){var l=jn({position:i},!0);t.push(l)}else{var s=(a={position:i},yn(Object(u.a)({char:"\xb7",solid:!1},a)));t.push(s)}},i=0;i<13;i+=1)r(i);return t}(t),i=r.filter((function(n){return"\xb7"===n.char})),a=V(i),o=Math.ceil(1.75*n),c=0;c<o;c+=1){var l=a.pop(),s=(e={position:l.position},yn(Object(u.a)({char:"G",solid:!0,behaviours:[ln,sn,fn],description:"You see a gooblini."},e)));r.push(s)}var f=r.filter((function(n){return"+"===n.char})),p=V(f),h=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";return yn(Object(u.a)({char:"down"===t?">":"<",health:999,description:"You see a staircase leading down"},n))}({position:p.pop().position});r.push(h);for(var d=0;d<2;d+=1){var b=(0,V(vn)[0])(n+1,{position:p.pop().position});r.push(b)}return r},En=function(n,t,e){var r={x:n.position.x+e.x,y:n.position.y+e.y};return!(nn(r,t).filter((function(n){return n.solid})).length>0)&&(n.position=r,!0)},kn=function(n,t,e){var r=Object(u.a)({},e,{position:n.position,owner:n});t.push(r)},Ln=function(n,t,e,r){for(;n.length>0;){var i=n.pop();if(t.actionPoints>=i.cost){if(t.actionPoints-=i.cost,"wait"===i.type&&(t.status.waiting=!0),"attack"===i.type){var a=i.value,o=i.target;o.health-=a,t.status.attacking=Q(o.position,t.position),r.shake=!0}if("move"===i.type&&En(t,e,i.direction),"spawn"===i.type){var c=i.entity;e.push(c)}"place-bomb"===i.type&&kn(t,e,i.bomb),"face"===i.type&&(t.facing=i.direction),"change-level"===i.type&&(r.changeLevel=!0)}}},Mn=function(n,t,e){n.status={},n.actionPoints=n.actionsPerTurn,n.prevPosition={x:n.position.x,y:n.position.y},Ln(n.actions,n,t,e),n.actions=[];var r=!0,i=!1,a=void 0;try{for(var o,c=n.behaviours[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=(0,o.value)(n,t).reverse();Ln(u,n,t,e)}}catch(l){i=!0,a=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}},Cn=(e(26),D={position:{x:1,y:1}},yn(Object(u.a)({char:"@",solid:!1,health:1,behaviours:[pn,hn],description:"It's you, the player",weapon:bn(1)},D))),Sn=On(1,Object(u.a)({},Cn));var zn=function(){var n=Object(r.useState)(1),t=Object(c.a)(n,2),e=t[0],a=t[1],o=Object(r.useState)(Sn),l=Object(c.a)(o,2),s=l[0],f=l[1],p=Object(r.useState)({}),h=Object(c.a)(p,2),d=h[0],b=h[1],v=!gn(s),m=e>5,y=function(){a(1),f(On(1,Object(u.a)({},Cn)))},g=Object(r.useCallback)((function(){a(0),f(On(e,Object(u.a)({},Cn)))}),[e]),w=Object(r.useCallback)((function(n){a(e+1),e<5&&f(On(e+1,n))}),[e]),k=Object(r.useCallback)((function(n){var t=gn(s),r=n.key,i=function(n){return{ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}}[n]}(r),a="z"===r.toLowerCase(),o="x"===r.toLowerCase(),c="r"===r.toLowerCase();if(0!==e||!o&&!a)if(!m&&!v||!o&&!a){if(t){if(i&&En(t,s,i),o)if(s.filter((function(n){return"b"===n.char&&"@"===n.owner.char})).length<t.weapon.capacity){var u=t.weapon.use(t);t.actions.push(u)}if(i||a||o){var l=function(n){for(var t={},e=gn(n),r=Object.values(n).filter((function(n){return n.id!==e.id})),i=0,a=[e].concat(Object(R.a)(r));i<a.length;i++){var o=a[i];Mn(o,n,t)}return{newEntities:Object.values(n).filter((function(n){return n.health>0})),newEvents:t}}(s),p=l.newEntities,h=l.newEvents;f(p),b(h),h.changeLevel&&w(t)}c&&y()}}else g();else y()}),[s,w,g,e,v,m]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",k),function(){window.removeEventListener("keydown",k)}}),[k]),i.a.createElement(x,null,0===e?i.a.createElement(O,null,i.a.createElement("h1",null,"bomblike"),i.a.createElement("button",{onClick:y},"play")):i.a.createElement(j,{className:"map-container",shake:!0===d.shake},(m||v)&&i.a.createElement(E,null,i.a.createElement("h2",null,m?"Success!":"You died"),i.a.createElement("button",{onClick:g},"Back to title")),i.a.createElement(_,{entities:s})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(zn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()}))}},[[15,1,2]]]);
//# sourceMappingURL=main.6e94988e.chunk.js.map