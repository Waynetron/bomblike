(this.webpackJsonpbomblike=this.webpackJsonpbomblike||[]).push([[0],{20:function(t,n,e){t.exports=e(35)},25:function(t,n,e){},28:function(t,n,e){},33:function(t,n,e){},34:function(t,n,e){},35:function(t,n,e){"use strict";e.r(n);var r=e(0),a=e.n(r),i=e(14),o=e.n(i),c=(e(25),e(3)),u=e(2),l=e(7),s=e(4),f=e(5);function p(){var t=Object(s.a)(["\n  ","\n  animation-name: 'shake';\n  flex-direction: column;\n"]);return p=function(){return t},t}function h(){var t=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  ","\n  ","\n  animation-name: ",";\n"]);return h=function(){return t},t}function m(){var t=Object(s.a)(["\n  ","\n  background-color: ",";\n  transition: background-color 0.2s cubic-bezier(0,1.56,.52,.99);\n  display: flex;\n  width: 100%;\n  height: 100%;\n"]);return m=function(){return t},t}function v(){var t=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return v=function(){return t},t}function d(){var t=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  animation-name: grow;\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n"]);return d=function(){return t},t}function y(){var t=Object(s.a)(["\n  @keyframes shake {\n    20% {\n      transform: translate3d(4px, -4px, 0);\n    }\n    40% {\n      transform: translate3d(-4px, 4px, 0);\n    }\n    60% {\n      transform: translate3d(4px, 4px, 0);\n    }\n    80% {\n      transform: translate3d(-4px, -4px, 0);\n    }\n  }\n\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n  animation-timing-function: cubic-bezier(.36,.07,.19,.97);\n"]);return y=function(){return t},t}var b=Object(f.a)(y()),g=Object(f.a)(d()),w=Object(f.a)(v()),x=f.b.div(m(),w,(function(t){return function(t,n){return t?"black":n?"#d42a2a":"black"}(t.win,t.lose)})),E=f.b.div(h(),b,g,(function(t){return t.shake?"shake, grow":void 0})),j=f.b.div(p(),w);e(28);function O(){var t=Object(s.a)(["\n  width: CELL_SIZE;\n  height: CELL_SIZE;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    border: solid 2px white;\n    cursor: pointer;\n    p {\n      color: white;\n    }\n    background-color: navy;\n    opacity: 1;\n  }\n\n  p {\n    display: inline;\n    margin-block-start: ","rem;\n    font-size: ",";\n    margin-block-end: 0;\n    font-weight: 700;\n\n  }\n"]);return O=function(){return t},t}function k(){var t=Object(s.a)(["\n  position: relative;\n  width: 0;\n  height: 0;\n"]);return k=function(){return t},t}var M=function(t){return{"@":"#fffa03","#":"black","+":"beige",">":"#fffa03","*":"#fffa03",b:"#fffa03","\xf3":"#fffa03","\u235a":"#fffa03","!":"white","\u2752":"white","\u2665":"#fffa03","\xb7":"tomato"}[t]||"tomato"},S=function(t){return{"#":"beige","+":"#4135ff","!":"tomato","\u2752":"black"}[t]||"transparent"},N=function(t,n){return"\xb7"===n?0:"\u2752"===n?1:"!"===n?4:"b"===n?3:t?2:1},C=f.b.div.attrs((function(t){var n=t.x,e=t.y,r=t.solid,a=t.char;return{style:{left:30*n+"px",top:30*e+"px",zIndex:N(r,a),color:M(a)}}}))(k()),I=f.b.div.attrs((function(t){var n=t.char,e=t.health;return{style:{opacity:"\xb7"!==n?"1":"".concat(20*e/100),width:"30px",height:"30px",backgroundColor:S(n)}}}))(O(),(function(t){return"*"===t.char?"1.5":"0.2"}),(function(t){return"*"===t.char?"3rem":"inherit"})),L=function(t){if(t.attacking){var n=t.attacking,e=n.x,r=n.y;if(e<0)return"bump-left";if(e>0)return"bump-right";if(r<0)return"bump-up";if(r>0)return"bump-down"}return""},z=function(t,n){return"b"===t&&1===n?"shake":""},A=function(t){var n=t.entity,e=t.hoverStart,r=void 0===e?function(){}:e,i=n.char,o=n.position,c=o.x,u=o.y,l=n.solid,s=n.status,f=n.health;return a.a.createElement(C,{x:c,y:u,solid:l,char:i},a.a.createElement(I,{char:i,health:n.health,className:"".concat(L(s)," ").concat(z(i,f)),onMouseEnter:function(){return r(n)}},a.a.createElement("p",null,function(t,n){return"+"===t?"#":"#"===t?"#":"b"===t?n>9?"!":n:"\u2752"===t?"":t}(i,f))))};function D(){var t=Object(s.a)(["\n  width: ","px;\n  height: ","px;\n  font-size: ","rem;\n  margin-bottom: 1rem;\n"]);return D=function(){return t},t}var P=f.b.div(D(),(function(t){return t.width}),(function(t){return t.height}),1.875),R=function(t){var n=t.entities,e=t.hoverStart,r=t.hoverStop;return a.a.createElement(P,{width:270,height:270,onMouseLeave:r},n.map((function(t){return a.a.createElement(A,{entity:t,key:t.id,hoverStart:e})})))},q=e(18),F={x:0,y:-1},B={x:0,y:1},Y={x:-1,y:0},J={x:1,y:0},K=function(t,n){return{x:t.x+n.x,y:t.y+n.y}},T=function(t,n){return{x:t.x-n.x,y:t.y-n.y}},W=function(t,n){var e=n.x,r=n.y,a=Object(q.a)(t,[e,r]),i=Object(l.a)(a,2);return{x:i[0],y:i[1]}},Z=function(t){for(var n=Object(c.a)(t),e=n.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),a=[n[r],n[e]];n[e]=a[0],n[r]=a[1]}return n},_=function(t,n){var e=t.x,r=t.y,a=n.x,i=n.y;return Math.sqrt(Math.pow(Math.abs(e-a),2)+Math.pow(Math.abs(r-i),2))},U=e(6),G=function(t,n){return n.filter((function(n){return Object(U.isEqual)(n.position,t)}))},H=function(t,n){return t.map((function(t){return G(t,n)})).flat()},Q=function(t){var n=t.x,e=t.y;return 0===n||8===n||0===e||8===e},V=function(t){return[K(F,t),K(B,t),K(Y,t),K(J,t)]},X=function(t,n,e){for(var r=[];e>0;){var a={x:t.x*e,y:t.y*e},i=K(n,a);r.push(i),e-=1}return r.reverse()},$=function(t,n,e,r,a){var i=X(n,e,r),o=!0,c=!1,u=void 0;try{for(var l,s=i[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var f=l.value,p=G(f,a),h=!0,m=!1,v=void 0;try{for(var d,y=p[Symbol.iterator]();!(h=(d=y.next()).done);h=!0){var b=d.value;if(b.char===t)return!0;if(b.solid)return!1}}catch(g){m=!0,v=g}finally{try{h||null==y.return||y.return()}finally{if(m)throw v}}}}catch(g){c=!0,u=g}finally{try{o||null==s.return||s.return()}finally{if(c)throw u}}return!1},tt=function(t,n){var e=G(t,n);return 0===e.length||!e.some((function(t){return t.solid}))},nt=function(t){return t.find((function(t){return"@"===t.char}))},et=function(t,n,e){t.weapon=n,Object(U.remove)(e,(function(t){return t.id===n.id}))};function rt(){var t=Object(s.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  span {\n    display: inline-block;\n  }\n  .trait {\n    color: #fffa03;\n    font-weight: 600;\n  }\n  .rare {\n    color: tomato;\n  }\n"]);return rt=function(){return t},t}function at(){var t=Object(s.a)(["\n  justify-content: start;\n  align-content: center;\n  flex-direction: column;\n  display: flex;\n  width: ","px;\n  min-height: 7rem;\n  \n  p {\n    text-align: center;\n    line-height: 1.5rem;\n    font-size: 1.2rem;\n    color: white;\n    font-weight: 400;\n    margin-top: 0.6rem;\n    margin-bottom: 0.5rem;\n  }\n  .key {\n    color: #fffa03;\n    font-weight: 600;\n  }\n"]);return at=function(){return t},t}var it=f.b.div(at(),(function(t){return t.width})),ot=f.b.div(rt()),ct=function(t){var n=t.entity;if(!n||!n.stats)return a.a.createElement(ot,null,a.a.createElement("p",null));var e=n.stats,r=e.capacity,i=e.power,o=e.radius,c=e.timer,u=e.canRemoteDetonate,l=function(t){return["","large","plentiful"][t-1]}(r),s=function(t){return[null,"powerful","very powerful","dangerously powerful"][t-1]}(i),f=function(t){return[null,"large radius","very large radius","dangerously large radius"][t-1]}(o),p=function(t){var n=null;return 2===t&&(n="short fuse"),5===t&&(n="long fuse"),n}(c);return a.a.createElement(ot,null,a.a.createElement("p",null,a.a.createElement("span",null,"A")," ",l&&a.a.createElement("span",{className:"trait"},l," ")," ",a.a.createElement("span",null,"bomb bag")," ",(s||f||p||u)&&a.a.createElement("span",null,"with")," ",s&&a.a.createElement("span",{className:"trait"},s," ")," ",f&&a.a.createElement("span",{className:"trait"},f," ")," ",p&&a.a.createElement("span",{className:"trait"},p," ")," ",u&&a.a.createElement("span",{className:"trait rare"},"remote control")," ",(s||f||p||u)&&a.a.createElement("span",null,"bombs")))},ut=function(t){var n=t.hovered,e=t.entities,r=t.win,i=t.lose,o=t.events;return a.a.createElement(it,{width:270},function(t,n,e,r,i){var o=nt(n),c=o?G(o.position,n):[],u=c.find((function(t){return">"===t.char})),l=c.find((function(t){return"weapon"===t.type}));if(!l&&!u&&!t&&!e&&!r)return null;var s=l||u||t;if(r){var f=i.playerKiller;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"You were killed by a ",a.a.createElement("span",{className:"key"},f?f.name:"something")),a.a.createElement("p",null,"Back to title ",a.a.createElement("span",{className:"key"},"(x)")))}return e?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"You conquered the dungeon. Way to go!"),a.a.createElement("p",null,"Back to title ",a.a.createElement("span",{className:"key"},"(x)"))):l?a.a.createElement(a.a.Fragment,null,a.a.createElement(ct,{entity:s}),a.a.createElement("p",null,"take ",a.a.createElement("span",{className:"key"},"(x)"))):u?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,s.description||""),a.a.createElement("p",null,"descend ",a.a.createElement("span",{className:"key"},"(x)"))):a.a.createElement(a.a.Fragment,null,t.stats?a.a.createElement(ct,{entity:t}):a.a.createElement("p",null,t.description||""))}(n,e,r,i,o))};function lt(){var t=Object(s.a)(["\n  font-size: 15rem;\n  color: beige;\n  font-weight: 700;\n  margin-top: 0;\n  margin-bottom: 3rem;\n  \n  .player {\n    color: #fffa03;\n  }\n"]);return lt=function(){return t},t}var st=f.b.p(lt()),ft=function(){return a.a.createElement(st,null,a.a.createElement("span",{className:"player"},"@"),"!")},pt=function(t){return Pt(Object(u.a)({char:"W",solid:!0,behaviours:[jt,Nt,Ct],name:"wanderer",description:"Moves until it hits something, then turns."},t))},ht=function(t){return Pt(Object(u.a)({char:"C",solid:!0,facing:{x:0,y:0},behaviours:[Ot,jt,Ct],name:"charger",description:"If it sees you, it charges toward you"},t))},mt=function(t){return Pt(Object(u.a)({char:"E",solid:!0,behaviours:[It,kt,Ct],name:"bombeater",description:"Eats bombs, om nom"},t))},vt=function(t){return Pt(Object(u.a)({char:"S",solid:!0,health:1,speed:"half",behaviours:[St,Ct],name:"seeker",description:"It just wants to be close to you"},t))},dt=function(t){return Pt(Object(u.a)({char:"s",solid:!1,health:5,behaviours:[xt],name:"ghost spawner",description:"",visible:!1},t))},yt=function(t,n){var e=[[pt],[pt,ht],[pt,ht,vt,mt],[pt,ht,vt,mt],[pt,ht,vt,mt]][t-1];return e[Math.floor(Math.random()*e.length)](n)},bt=function(t){return"\u2752"!==t.char&&!(!t.solid&&"@"!==t.char)},gt=function(t,n){return G(t,n).find(bt)},wt=function(t,n){var e=t.radius,r=t.power;if(t.health-=1,t.health>0)return[];for(var a=[t.position],i=[t.position],o=0,u=[F,B,Y,J];o<u.length;o++){var l=X(u[o],t.position,e),s=l.findIndex((function(t){return gt(t,n)}));-1!==s?(a.push(l[s]),i.push.apply(i,Object(c.a)(l.slice(0,s+1)))):i.push.apply(i,Object(c.a)(l))}var f=H(a,n).map((function(t){return{type:"attack",value:r,target:t,cost:0}})),p=i.map((function(t){return{type:"spawn",value:1,entity:qt({position:t}),cost:0}}));return[].concat(Object(c.a)(f),Object(c.a)(p))},xt=function(t,n){if(t.health-=1,t.health>0)return[];var e,r=t.position;return[{type:"spawn",value:1,entity:(e={position:r},Pt(Object(u.a)({char:"!",solid:!1,health:99,speed:"half",behaviours:[Mt,Ct],name:"time cop",description:"Oh no, it's the fun police!"},e))),cost:0}]},Et=function(t,n){return[{type:"attack",value:1,target:t,cost:0}]},jt=function(t,n){return[{type:"move",direction:t.facing,cost:1}]},Ot=function(t,n){for(var e=0,r=[F,B,Y,J];e<r.length;e++){var a=r[e];if($("@",a,t.position,12,n))return[{type:"move",direction:a,cost:1},{type:"face",direction:a,cost:0}]}return[]},kt=function(t,n){for(var e=0,r=[F,B,Y,J];e<r.length;e++){var a=r[e];if($("b",a,t.position,12,n))return[{type:"move",direction:a,cost:1},{type:"face",direction:a,cost:0}]}return[]},Mt=function(t,n){var e=nt(n),r=e.position.x>t.position.x?1:-1,a=e.position.y>t.position.y?1:-1;return[{type:"move",direction:Math.random()>.5?{x:0,y:a}:{x:r,y:0},cost:1,force:!0}]},St=function(t,n){for(var e,r=nt(n),a=_(t.position,r.position),i=0,o=[F,B,Y,J];i<o.length;i++){var c=o[i],u=K(c,t.position),l=_(u,r.position);tt(u,n)&&l<a&&(e=c,a=l)}return e?[{type:"move",direction:e,cost:1}]:[]},Nt=function(t,n){for(var e=t.facing,r=0,a=[e,W(-90,e),W(90,e),W(180,e)];r<a.length;r++){var i=a[r],o=K(i,t.position);if(tt(o,n))return[{type:"face",direction:i,cost:0}]}return[]},Ct=function(t,n){var e=G(t.position,n).find((function(t){return"@"===t.char}));return e?[{type:"attack",value:1,target:e,cost:0}]:[]},It=function(t,n){var e=V(t.position),r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=o.value,l=G(u,n).find((function(t){return"b"===t.char}));if(l)return[{type:"eat",target:l,cost:0},{type:"move",direction:T(u,t.position),cost:1}]}}catch(s){a=!0,i=s}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return[]},Lt=function(t,n,e){return Pt(Object(u.a)({char:"\xf3",type:"weapon",solid:!1,health:999,capacity:t.capacity||1,description:"A standard bomb bag",stats:{radius:n.radius,power:n.power,capacity:t.capacity,timer:n.health,canRemoteDetonate:n.canRemoteDetonate||!1},use:function(t,e){return function(t,n,e){var r=n.filter((function(t){return"b"===t.char&&"@"===t.owner.char}));if(r.length<t.weapon.capacity)return[{type:"place-bomb",cost:1,bomb:Rt(Object(u.a)({},e,{position:t.position}))}];if(e.canRemoteDetonate){var a=r.map((function(t){return{type:"attack",target:t,value:t.health,cost:0}}));return[].concat(Object(c.a)(a),[{type:"wait",cost:1}])}return[]}(t,e,n)}},e))},zt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e={capacity:1,description:"A starter bomb bag"},r={radius:Math.ceil(Math.random()*t),health:3,power:1};return Lt(e,r,n)},At=[function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e={radius:2},r={radius:3},a={health:2},i={health:5},o={health:999},c={canRemoteDetonate:!0},l={},s={},f=[[r,i],[a],[e],[a,e],[r],[c,o],[c,o,e]],p=Z(f).pop(),h=!0,m=!1,v=void 0;try{for(var d,y=p[Symbol.iterator]();!(h=(d=y.next()).done);h=!0){var b=d.value;s=Object(u.a)({},s,{},b)}}catch(g){m=!0,v=g}finally{try{h||null==y.return||y.return()}finally{if(m)throw v}}return Lt(l,s,n)}],Dt=0,Pt=function(t){return t.position||console.error("entity was created without a position",t),t.id&&console.error("Entity should probably not have a custom ID"),Object(u.a)({id:Dt++,name:"thing",char:"?",weapon:null,facing:{x:0,y:1},alive:!0,solid:!1,behaviours:[],actions:[],actionsPerTurn:1,status:{},health:1,description:"",visible:!0},t)},Rt=function(t){return Pt(Object(u.a)({char:"b",name:"bomb",solid:!0,behaviours:[wt],description:"It's a bomb, and it's going to explode!",health:3,power:1,radius:1},t))},qt=function(t){return Pt(Object(u.a)({char:"*",name:"flame",solid:!1,behaviours:[Et],health:1},t))},Ft=function(t){return Pt(Object(u.a)({char:"\xb7",name:"trail",solid:!1,behaviours:[Et],health:3},t))},Bt=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Pt(Object(u.a)({char:n?"+":"#",name:"breakable wall",health:n?1:999,solid:!0,description:"You see a wall. ".concat(n?"":"It seems unbreakable.")},t))},Yt=function(t,n){return t.sort((function(t,e){return _(t.position,n.position)-_(e.position,n.position)})),t.slice(Math.floor(t.length/4))},Jt=function(t,n){for(var e=function(t){for(var n=[t],e=[],r=0;r<9;r+=1)for(var a=function(a){var i={x:r,y:a};if(Object(U.isEqual)(i,t.position))return"continue";var o,c=V(t.position).find((function(t){return Object(U.isEqual)(i,t)}));if(Q(i)||r%2===0&&a%2===0){var l=Bt({position:i},!1);n.push(l)}else if(!c){var s=(o={position:i},Pt(Object(u.a)({char:"\xb7",solid:!1},o)));e.push(s)}},i=0;i<9;i+=1)a(i);for(var o,l=Z(e),s=e.length-16,f=Math.min(Math.random()*(s/4)+5,s),p=s-f,h=Math.min(Math.random()*p/2,0),m=0;m<f;m+=1){var v=l.pop().position;n.push(Bt({position:v},!0))}for(var d=0;d<h;d+=1){var y=l.pop().position;n.push((o={position:y},Pt(Object(u.a)({char:"\u2752",name:"hole",solid:!0,description:"A hole in the ground",health:999},o))))}return[].concat(n,Object(c.a)(l))}(n),r=e.filter((function(t){return"\xb7"===t.char})),a=Z(Yt(r,n)),i=Math.ceil(1.75*t),o=0;o<i;o+=1){var l=a.pop(),s=yt(t,{position:l.position});e.push(s)}for(var f=0,p=[{health:75,position:{x:-2,y:-2}},{health:100,position:{x:10,y:-2}},{health:125,position:{x:10,y:10}},{health:150,position:{x:-2,y:10}}];f<p.length;f++){var h=dt(p[f]);e.push(h)}var m=e.filter((function(t){return"+"===t.char})),v=Z(Yt(m,n)),d=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";return Pt(Object(u.a)({char:"down"===n?">":"<",name:"staircase",health:999,description:"You see a staircase leading down"},t))}({position:v.pop().position});e.push(d);var y=(0,Z(At)[0])(t+1,{position:v.pop().position});return e.push(y),e.filter((function(t){return"\xb7"!==t.char}))},Kt=0,Tt=function(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:t.position.x+e.x,y:t.position.y+e.y},i=G(a,n);return!(!r&&i.filter((function(t){return t.solid})).length>0)&&(n.push(Ft({position:t.position})),t.position=a,!0)},Wt=function(t,n,e){var r=Object(u.a)({},e,{position:t.position,owner:t});n.push(r)},Zt=function(t,n,e,r){for(var a=nt(e);t.length>0;){var i=t.pop();if(n.actionPoints>=i.cost){if(n.actionPoints-=i.cost,"eat"===i.type&&(i.target.alive=!1,i.target.solid=!1,r.shake=!0),"attack"===i.type){var o=i.value,c=i.target;c.armour?c.armour.defense-=o:c.health-=o,n.status.attacking=T(c.position,n.position),"\xb7"!==c.char&&(r.shake=!0),c.id===a.id&&a.health<=0&&(r.playerKiller=n)}if("move"===i.type&&Tt(n,e,i.direction,i.force),"pick-up"===i.type){var u=i.entity,l=i.target;et(u,l,e)}if("spawn"===i.type){var s=i.entity;e.push(s)}"place-bomb"===i.type&&Wt(n,e,i.bomb),"face"===i.type&&(n.facing=i.direction)}}},_t=function(t,n,e){if("half"!==t.speed||Kt%2!==0){t.status={},t.actionPoints=t.actionsPerTurn,t.prevPosition={x:t.position.x,y:t.position.y},Zt(t.actions,t,n,e),t.actions=[];var r=!0,a=!1,i=void 0;try{for(var o,c=t.behaviours[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=(0,o.value)(t,n).reverse();Zt(u,t,n,e)}}catch(l){a=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}}},Ut=function(t,n){var e=nt(n),r=[];if("direction"===t.type){var a={type:"move",direction:t.direction,cost:1};r.push(a)}if("primary"===t.type){var i=function(t,n){return G(t,n).find((function(t){return"weapon"===t.type}))}(e.position,n);if(i){var o={type:"pick-up",entity:e,target:i,cost:1};r.push(o)}else{var u=e.weapon.use(e,n);r.push.apply(r,Object(c.a)(u))}}return r};e(33),e(34);var Gt=function(){var t=Object(r.useState)(0),n=Object(l.a)(t,2),e=n[0],i=n[1],o=Object(r.useState)([]),s=Object(l.a)(o,2),f=s[0],p=s[1],h=Object(r.useState)({}),m=Object(l.a)(h,2),v=m[0],d=m[1],y=Object(r.useState)({}),b=Object(l.a)(y,2),g=b[0],w=b[1],O=f.length&&!nt(f),k=e>5,M=function(){var t;i(1),p(Jt(1,Object(u.a)({},(t={position:{x:1,y:1}},Pt(Object(u.a)({char:"@",name:"player",solid:!1,health:1,behaviours:[],description:"It's you, the player",weapon:zt(1),armour:null},t))))))},S=Object(r.useCallback)((function(){i(0),p([])}),[]),N=Object(r.useCallback)((function(t){i(e+1),e<5&&p(Jt(e+1,t))}),[e]),C=Object(r.useCallback)((function(t){var n=nt(f),r=function(t){var n=function(t){return{ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}}[t]}(t);return n?{type:"direction",direction:n}:"x"===t.toLowerCase()?{type:"primary"}:"z"===t.toLowerCase()?{type:"wait"}:"r"===t.toLowerCase()?{type:"restart"}:{type:"unknown"}}(t.key);if("direction"===r.type&&t.preventDefault(),0!==e||"primary"!==r.type)if(!k&&!O||"primary"!==r.type)if("restart"!==r.type){if("primary"===r.type&&function(t,n){var e=G(t.position,n).find((function(t){return">"===t.char}));return Boolean(e)}(n,f))N(n);else if(n&&("direction"===r.type||"wait"===r.type||"primary"===r.type)){var a,i=Ut(r,f);(a=n.actions).push.apply(a,Object(c.a)(i));var o=function(t,n){for(var e={},r=nt(n),a=n.filter((function(t){return t.id!==r.id})),i=0,o=[r].concat(Object(c.a)(a));i<o.length;i++){var u=o[i];_t(u,n,e)}var l=!0,s=!1,f=void 0;try{for(var p,h=n[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var m=p.value;m.armour&&m.armour.defense<=0&&(m.armour=null),m.health<=0&&(m.alive=!1)}}catch(d){s=!0,f=d}finally{try{l||null==h.return||h.return()}finally{if(s)throw f}}var v=n.filter((function(t){return t.alive}));return Kt++,{newEntities:v,newEvents:e}}(0,f),u=o.newEntities,l=o.newEvents;p(u),d(l)}}else M();else S();else M()}),[f,N,S,e,O,k]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",C),function(){window.removeEventListener("keydown",C)}}),[C]),a.a.createElement(x,{win:k,lose:O},0===e?a.a.createElement(j,null,a.a.createElement("h1",null,"bomblike"),a.a.createElement("button",{onClick:M},"play ",a.a.createElement("span",{className:"key"},"(x)"))):a.a.createElement(E,{className:"map-container",shake:!0===v.shake},k?a.a.createElement(ft,null):a.a.createElement(R,{entities:f.filter((function(t){return t.visible})),hoverStart:function(t){w(t)},hoverEnd:function(){w(null)}}),a.a.createElement(ut,{entities:f,hovered:g,win:k,lose:O,events:v})))};o.a.render(a.a.createElement(Gt,null),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.34ef8280.chunk.js.map