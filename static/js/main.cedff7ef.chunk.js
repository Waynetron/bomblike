(this.webpackJsonproguelike=this.webpackJsonproguelike||[]).push([[0],{20:function(n,t,e){n.exports=e(34)},25:function(n,t,e){},28:function(n,t,e){},33:function(n,t,e){},34:function(n,t,e){"use strict";e.r(t);var r=e(0),a=e.n(r),i=e(14),o=e.n(i),c=(e(25),e(7)),u=e(1),l=e(3),s=e(4);function f(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  position: absolute;\n  z-index: 999;\n  background-color: beige;\n  padding: 2rem;\n\n  h2, button {\n    color: #4135ff;\n  }\n\n  button:hover {\n    background-color: #4135ff;\n    border-color: #4135ff;\n    color: beige\n  }\n\n  h2 {\n    font-size: 3rem;\n    line-height: 3rem;\n    margin: 0rem;\n    margin-bottom: 1rem;\n  }\n"]);return f=function(){return n},n}function h(){var n=Object(l.a)(["\n  ","\n  animation-name: 'shake';\n  flex-direction: column;\n"]);return h=function(){return n},n}function p(){var n=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  ","\n  ","\n  animation-name: ",";\n"]);return p=function(){return n},n}function m(){var n=Object(l.a)(["\n  ","\n  background-color: ",";\n  transition: background-color 0.2s cubic-bezier(0,1.56,.52,.99);\n  display: flex;\n  width: 100%;\n  height: 100%;\n"]);return m=function(){return n},n}function d(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return d=function(){return n},n}function v(){var n=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  animation-name: grow;\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n"]);return v=function(){return n},n}function b(){var n=Object(l.a)(["\n  @keyframes shake {\n    20% {\n      transform: translate3d(4px, -4px, 0);\n    }\n    40% {\n      transform: translate3d(-4px, 4px, 0);\n    }\n    60% {\n      transform: translate3d(4px, 4px, 0);\n    }\n    80% {\n      transform: translate3d(-4px, -4px, 0);\n    }\n  }\n\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n  animation-timing-function: cubic-bezier(.36,.07,.19,.97);\n"]);return b=function(){return n},n}var y=Object(s.a)(b()),g=Object(s.a)(v()),w=Object(s.a)(d()),x=s.b.div(m(),w,(function(n){return function(n,t){return n?"black":t?"#d42a2a":"black"}(n.win,n.lose)})),j=s.b.div(p(),y,g,(function(n){return n.shake?"shake, grow":void 0})),E=s.b.div(h(),w);s.b.div(f()),e(28);function O(){var n=Object(l.a)(["\n  width: CELL_SIZE;\n  height: CELL_SIZE;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    border: solid 2px white;\n    cursor: pointer;\n    p {\n      color: white;\n    }\n    background-color: navy;\n    opacity: 1;\n  }\n\n  p {\n    display: inline;\n    margin-block-start: 0.2rem;\n    margin-block-end: 0;\n    font-weight: 700;\n  }\n"]);return O=function(){return n},n}function k(){var n=Object(l.a)(["\n  position: relative;\n  width: 0;\n  height: 0;\n"]);return k=function(){return n},n}var M=function(n){return{"@":"#fffa03","#":"black","+":"beige",">":"#fffa03","\u2731":"#fffa03",b:"#fffa03","\xf3":"#fffa03","\u235a":"#fffa03",S:"#fffa03","!":"white","\u2752":"white","\u2665":"#fffa03","\xb7":"tomato"}[n]||"tomato"},S=function(n){return{"#":"beige","+":"#4135ff","!":"tomato","\u2752":"black"}[n]||"transparent"},L=function(n,t){return"\xb7"===t?0:"\u2752"===t?1:"!"===t?4:"b"===t?3:n?2:1},N=s.b.div.attrs((function(n){var t=n.x,e=n.y,r=n.solid,a=n.char;return{style:{left:30*t+"px",top:30*e+"px",zIndex:L(r,a),color:M(a)}}}))(k()),C=s.b.div.attrs((function(n){var t=n.char,e=n.health;return{style:{opacity:"\xb7"!==t?"100%":"".concat(15*e,"%"),width:"30px",height:"30px",backgroundColor:S(t)}}}))(O()),I=function(n){if(n.attacking){var t=n.attacking,e=t.x,r=t.y;if(e<0)return"bump-left";if(e>0)return"bump-right";if(r<0)return"bump-up";if(r>0)return"bump-down"}return""},z=function(n,t){return"b"===n&&1===t?"shake":""},A=function(n){var t=n.entity,e=n.hoverStart,r=void 0===e?function(){}:e,i=t.char,o=t.position,c=o.x,u=o.y,l=t.solid,s=t.status,f=t.health;return a.a.createElement(N,{x:c,y:u,solid:l,char:i},a.a.createElement(C,{char:i,health:t.health,className:"".concat(I(s)," ").concat(z(i,f)),onMouseEnter:function(){return r(t)}},a.a.createElement("p",null,function(n,t){return"+"===n?"#":"#"===n?"#":"b"===n?t:"\u2752"===n?"":n}(i,f))))};function P(){var n=Object(l.a)(["\n  width: ","px;\n  height: ","px;\n  font-size: ","rem;\n  margin-bottom: 1rem;\n"]);return P=function(){return n},n}var q=s.b.div(P(),(function(n){return n.width}),(function(n){return n.height}),1.875),B=function(n){var t=n.entities,e=n.hoverStart,r=n.hoverStop;return a.a.createElement(q,{width:270,height:270,onMouseLeave:r},t.map((function(n){return a.a.createElement(A,{entity:n,key:n.id,hoverStart:e})})))},F=e(5),W=e(18),Y={x:0,y:-1},D={x:0,y:1},J={x:-1,y:0},K={x:1,y:0},T=function(n,t){return{x:n.x+t.x,y:n.y+t.y}},Z=function(n,t){return{x:n.x-t.x,y:n.y-t.y}},_=function(n,t){var e=t.x,r=t.y,a=Object(W.a)(n,[e,r]),i=Object(c.a)(a,2);return{x:i[0],y:i[1]}},R=function(n){for(var t=Object(F.a)(n),e=t.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),a=[t[r],t[e]];t[e]=a[0],t[r]=a[1]}return t},U=function(n,t){var e=n.x,r=n.y,a=t.x,i=t.y;return Math.sqrt(Math.pow(Math.abs(e-a),2)+Math.pow(Math.abs(r-i),2))},$=e(6),G=function(n,t){return t.filter((function(t){return Object($.isEqual)(t.position,n)}))},H=function(n,t){return n.map((function(n){return G(n,t)})).flat()},Q=function(n){var t=n.x,e=n.y;return 0===t||8===t||0===e||8===e},V=function(n){return[T(Y,n),T(D,n),T(J,n),T(K,n)]},X=function(n,t,e){for(var r=[];e>0;){var a={x:n.x*e,y:n.y*e},i=T(t,a);r.push(i),e-=1}return r.reverse()},nn=function(n,t,e,r,a){var i=X(t,e,r),o=!0,c=!1,u=void 0;try{for(var l,s=i[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var f=l.value,h=G(f,a),p=!0,m=!1,d=void 0;try{for(var v,b=h[Symbol.iterator]();!(p=(v=b.next()).done);p=!0){var y=v.value;if(y.char===n)return!0;if(y.solid)return!1}}catch(g){m=!0,d=g}finally{try{p||null==b.return||b.return()}finally{if(m)throw d}}}}catch(g){c=!0,u=g}finally{try{o||null==s.return||s.return()}finally{if(c)throw u}}return!1},tn=function(n,t){var e=G(n,t);return 0===e.length||!e.some((function(n){return n.solid}))},en=e(8),rn=function(n){return Sn(Object(u.a)({char:"W",solid:!0,behaviours:[dn,wn,xn],name:"wanderer",description:"Moves until it hits something, then turns."},n))},an=function(n){var t;return Sn(Object(u.a)((t={char:"C",name:"charger",solid:!0,facing:{x:0,y:0},behaviours:[vn,dn,xn]},Object(en.a)(t,"name","charger"),Object(en.a)(t,"description","If it sees you, it charges toward you"),t),n))},on=function(n){return Sn(Object(u.a)({char:"E",solid:!0,behaviours:[jn,bn,xn],name:"bombeater",description:"Eats bombs, om nom"},n))},cn=function(n){return Sn(Object(u.a)({char:"S",solid:!0,health:1,speed:"half",behaviours:[gn,xn],name:"seeker",description:"It just wants to be close to you"},n))},un=function(n){return Sn(Object(u.a)({char:"s",solid:!1,health:5,behaviours:[pn],name:"ghost spawner",description:"",visible:!1},n))},ln=function(n,t){var e=[[rn],[rn,an],[rn,an,cn,on],[rn,an,cn,on],[rn,an,cn,on]][n-1];return e[Math.floor(Math.random()*e.length)](t)},sn=function(n){return"\u2752"!==n.char&&!(!n.solid&&"@"!==n.char)},fn=function(n,t){return G(n,t).find(sn)},hn=function(n,t){var e=n.radius,r=n.power;if(n.health-=1,n.health>0)return[];for(var a=[n.position],i=[n.position],o=0,c=[Y,D,J,K];o<c.length;o++){var u=X(c[o],n.position,e),l=u.findIndex((function(n){return fn(n,t)}));-1!==l?(a.push(u[l]),i.push.apply(i,Object(F.a)(u.slice(0,l+1)))):i.push.apply(i,Object(F.a)(u))}var s=H(a,t).map((function(n){return{type:"attack",value:r,target:n,cost:0}})),f=i.map((function(n){return{type:"spawn",value:1,entity:Cn({position:n}),cost:0}}));return[].concat(Object(F.a)(s),Object(F.a)(f))},pn=function(n,t){if(n.health-=1,n.health>0)return[];var e,r=n.position;return[{type:"spawn",value:1,entity:(e={position:r},Sn(Object(u.a)({char:"!",solid:!1,health:99,speed:"half",behaviours:[yn,xn],name:"hunger clock",description:"Oh no, it's the fun police!"},e))),cost:0}]},mn=function(n,t){return[{type:"attack",value:1,target:n,cost:0}]},dn=function(n,t){return[{type:"move",direction:n.facing,cost:1}]},vn=function(n,t){for(var e=0,r=[Y,D,J,K];e<r.length;e++){var a=r[e];if(nn("@",a,n.position,12,t))return[{type:"move",direction:a,cost:1},{type:"face",direction:a,cost:0}]}return[]},bn=function(n,t){for(var e=0,r=[Y,D,J,K];e<r.length;e++){var a=r[e];if(nn("b",a,n.position,12,t))return[{type:"move",direction:a,cost:1},{type:"face",direction:a,cost:0}]}return[]},yn=function(n,t){var e=Ln(t),r=e.position.x>n.position.x?1:-1,a=e.position.y>n.position.y?1:-1;return[{type:"move",direction:Math.random()>.5?{x:0,y:a}:{x:r,y:0},cost:1,force:!0}]},gn=function(n,t){for(var e,r=Ln(t),a=U(n.position,r.position),i=0,o=[Y,D,J,K];i<o.length;i++){var c=o[i],u=T(c,n.position),l=U(u,r.position);tn(u,t)&&l<a&&(e=c,a=l)}return e?[{type:"move",direction:e,cost:1}]:[]},wn=function(n,t){for(var e=n.facing,r=0,a=[e,_(-90,e),_(90,e),_(180,e)];r<a.length;r++){var i=a[r],o=T(i,n.position);if(tn(o,t))return[{type:"face",direction:i,cost:0}]}return[]},xn=function(n,t){var e=G(n.position,t).find((function(n){return"@"===n.char}));return e?[{type:"attack",value:1,target:e,cost:0}]:[]},jn=function(n,t){var e=V(n.position),r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=o.value,l=G(u,t).find((function(n){return"b"===n.char}));if(l)return[{type:"eat",target:l,cost:0},{type:"move",direction:Z(u,n.position),cost:1}]}}catch(s){a=!0,i=s}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return[]},En=function(n,t,e){return Sn(Object(u.a)({char:"\xf3",type:"weapon",solid:!1,health:999,capacity:n.capacity||1,description:"A standard bomb bag",stats:{radius:t.radius,power:t.power,capacity:n.capacity,timer:t.health},use:function(n){return{type:"place-bomb",cost:1,bomb:Nn(Object(u.a)({},t,{position:n.position}))}}},e))},On=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e={capacity:1,description:"A standard bomb bag"},r={radius:Math.ceil(Math.random()*n),health:3,power:1};return En(e,r,t)},kn=[function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=3*Math.random()+n,r=1;e>4?r=2:e>6&&(r=3);var a={capacity:3},i={radius:2},o={radius:3},c={health:2},l={health:5},s={},f={},h=R([i,o,c,l]),p=h.slice(0,r),m=!0,d=!1,v=void 0;try{for(var b,y=p[Symbol.iterator]();!(m=(b=y.next()).done);m=!0){var g=b.value;g===a?s=Object(u.a)({},s,{},g):f=Object(u.a)({},f,{},g)}}catch(w){d=!0,v=w}finally{try{m||null==y.return||y.return()}finally{if(d)throw v}}return En(s,f,t)}],Mn=0,Sn=function(n){return n.position||console.error("entity was created without a position",n),n.id&&console.error("Entity should probably not have a custom ID"),Object(u.a)({id:Mn++,name:"thing",char:"?",weapon:null,facing:{x:0,y:1},alive:!0,solid:!1,behaviours:[],actions:[],actionsPerTurn:1,status:{},health:1,description:"",visible:!0},n)},Ln=function(n){return n.find((function(n){return"@"===n.char}))},Nn=function(n){return Sn(Object(u.a)({char:"b",name:"bomb",solid:!0,behaviours:[hn],description:"It's a bomb, and it's going to explode!",health:3,power:1,radius:1},n))},Cn=function(n){return Sn(Object(u.a)({char:"\u2731",name:"flame",solid:!1,behaviours:[mn],health:1},n))},In=function(n){return Sn(Object(u.a)({char:"\xb7",name:"trail",solid:!1,behaviours:[mn],health:3},n))},zn=function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Sn(Object(u.a)({char:t?"+":"#",name:"breakable wall",health:t?1:999,solid:!0,description:"You see a wall. ".concat(t?"":"It seems unbreakable.")},n))};function An(){var n=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  span {\n    display: inline-block;\n  }\n  .trait {\n    color: #fffa03;\n    font-weight: 600;\n  }\n"]);return An=function(){return n},n}function Pn(){var n=Object(l.a)(["\n  justify-content: start;\n  align-content: center;\n  flex-direction: column;\n  display: flex;\n  width: ","px;\n  min-height: 7rem;\n  \n  p {\n    text-align: center;\n    line-height: 1.5rem;\n    font-size: 1.2rem;\n    color: white;\n    font-weight: 400;\n    margin-top: 0.6rem;\n    margin-bottom: 0.5rem;\n  }\n  .key {\n    color: #fffa03;\n    font-weight: 600;\n  }\n"]);return Pn=function(){return n},n}var qn=s.b.div(Pn(),(function(n){return n.width})),Bn=s.b.div(An()),Fn=function(n){var t=n.entity;if(!t||!t.stats)return a.a.createElement(Bn,null,a.a.createElement("p",null));var e=t.stats,r=e.capacity,i=e.power,o=e.radius,c=e.timer,u=function(n){return["","large","plentiful"][n-1]}(r),l=function(n){return[null,"powerful","very powerful","dangerously powerful"][n-1]}(i),s=function(n){return[null,"large radius","very large radius","dangerously large radius"][n-1]}(o),f=function(n){var t=null;return 2===n&&(t="short fuse"),5===n&&(t="long fuse"),t}(c);return a.a.createElement(Bn,null,a.a.createElement("p",null,a.a.createElement("span",null,"A")," ",u&&a.a.createElement("span",{className:"trait"},u," ")," ",a.a.createElement("span",null,"bomb bag")," ",(l||s||f)&&a.a.createElement("span",null,"with")," ",l&&a.a.createElement("span",{className:"trait"},l," ")," ",s&&a.a.createElement("span",{className:"trait"},s," ")," ",f&&a.a.createElement("span",{className:"trait"},f," ")," ",(l||s||f)&&a.a.createElement("span",null,"bombs")))},Wn=function(n){var t=n.hovered,e=n.entities,r=n.win,i=n.lose,o=n.events;return a.a.createElement(qn,{width:270},function(n,t,e,r,i){var o=Ln(t),c=o?G(o.position,t):[],u=c.find((function(n){return">"===n.char})),l=c.find((function(n){return"weapon"===n.type}));if(!l&&!u&&!n&&!e&&!r)return null;var s=l||u||n;if(r){var f=i.playerKiller;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"You were killed by a ",a.a.createElement("span",{className:"key"},f?f.name:"something")),a.a.createElement("p",null,"Back to title ",a.a.createElement("span",{className:"key"},"(x)")))}return e?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"You conquered the dungeon. Way to go!"),a.a.createElement("p",null,"Back to title ",a.a.createElement("span",{className:"key"},"(x)"))):l?a.a.createElement(a.a.Fragment,null,a.a.createElement(Fn,{entity:s}),a.a.createElement("p",null,"take ",a.a.createElement("span",{className:"key"},"(x)"))):u?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,s.description||""),a.a.createElement("p",null,"descend ",a.a.createElement("span",{className:"key"},"(x)"))):a.a.createElement(a.a.Fragment,null,n.stats?a.a.createElement(Fn,{entity:n}):a.a.createElement("p",null,n.description||""))}(t,e,r,i,o))};function Yn(){var n=Object(l.a)(["\n    font-size: 15rem;\n    color: beige;\n    font-weight: 700;\n    margin-top: 0;\n    margin-bottom: 3rem;\n  }\n  .player {\n    color: #fffa03;\n  }\n"]);return Yn=function(){return n},n}var Dn,Jn=s.b.p(Yn()),Kn=function(){return a.a.createElement(Jn,null,a.a.createElement("span",{className:"player"},"@"),"!")},Tn=function(n,t){for(var e=function(n){for(var t=[n],e=[],r=0;r<9;r+=1)for(var a=function(a){var i={x:r,y:a};if(Object($.isEqual)(i,n.position))return"continue";var o,c=V(n.position).find((function(n){return Object($.isEqual)(i,n)}));if(Q(i)||r%2===0&&a%2===0){var l=zn({position:i},!1);t.push(l)}else if(!c){var s=(o={position:i},Sn(Object(u.a)({char:"\xb7",solid:!1},o)));e.push(s)}},i=0;i<9;i+=1)a(i);for(var o,c=R(e),l=e.length-16,s=Math.min(Math.random()*(l/4)+5,l),f=l-s,h=Math.min(Math.random()*f/2,0),p=0;p<s;p+=1){var m=c.pop().position;t.push(zn({position:m},!0))}for(var d=0;d<h;d+=1){var v=c.pop().position;t.push((o={position:v},Sn(Object(u.a)({char:"\u2752",name:"hole",solid:!0,description:"A hole in the ground",health:999},o))))}return[].concat(t,Object(F.a)(c))}(t),r=e.filter((function(n){return"\xb7"===n.char})),a=R(r),i=Math.ceil(1.75*n),o=0;o<i;o+=1){var c=a.pop(),l=ln(n,{position:c.position});e.push(l)}for(var s=0,f=[{health:75,position:{x:-2,y:-2}},{health:100,position:{x:10,y:-2}},{health:125,position:{x:10,y:10}},{health:150,position:{x:-2,y:10}}];s<f.length;s++){var h=un(f[s]);e.push(h)}var p=e.filter((function(n){return"+"===n.char}));p.sort((function(n,e){return U(n.position,t.position)-U(e.position,t.position)}));var m=p.slice(Math.floor(p.length/3)),d=R(m),v=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";return Sn(Object(u.a)({char:"down"===t?">":"<",name:"staircase",health:999,description:"You see a staircase leading down"},n))}({position:d.pop().position});e.push(v);var b=(0,R(kn)[0])(n+1,{position:d.pop().position});return e.push(b),e.filter((function(n){return"\xb7"!==n.char}))},Zn=0,_n=function(n,t,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:n.position.x+e.x,y:n.position.y+e.y},i=G(a,t);return!(!r&&i.filter((function(n){return n.solid})).length>0)&&(t.push(In({position:n.position})),n.position=a,!0)},Rn=function(n,t,e){var r=Object(u.a)({},e,{position:n.position,owner:n});t.push(r)},Un=function(n,t,e,r){for(var a=Ln(e);n.length>0;){var i=n.pop();if(t.actionPoints>=i.cost){if(t.actionPoints-=i.cost,"wait"===i.type&&(t.status.waiting=!0),"eat"===i.type&&(i.target.alive=!1,i.target.solid=!1,r.shake=!0),"attack"===i.type){var o=i.value,c=i.target;c.armour?c.armour.defense-=o:c.health-=o,t.status.attacking=Z(c.position,t.position),r.shake=!0,c.id===a.id&&a.health<=0&&(r.playerKiller=t)}if("move"===i.type&&_n(t,e,i.direction,i.force),"spawn"===i.type){var u=i.entity;e.push(u)}"place-bomb"===i.type&&Rn(t,e,i.bomb),"face"===i.type&&(t.facing=i.direction),"change-level"===i.type&&(r.changeLevel=!0)}}},$n=function(n,t,e){if("half"!==n.speed||Zn%2!==0){n.status={},n.actionPoints=n.actionsPerTurn,n.prevPosition={x:n.position.x,y:n.position.y},Un(n.actions,n,t,e),n.actions=[];var r=!0,a=!1,i=void 0;try{for(var o,c=n.behaviours[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=(0,o.value)(n,t).reverse();Un(u,n,t,e)}}catch(l){a=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}}},Gn=(e(33),Dn={position:{x:1,y:1}},Sn(Object(u.a)({char:"@",name:"player",solid:!1,health:1,behaviours:[],description:"It's you, the player",weapon:On(1),armour:null},Dn))),Hn=Tn(0,Object(u.a)({},Gn));var Qn=function(){var n=Object(r.useState)(0),t=Object(c.a)(n,2),e=t[0],i=t[1],o=Object(r.useState)(Hn),l=Object(c.a)(o,2),s=l[0],f=l[1],h=Object(r.useState)({}),p=Object(c.a)(h,2),m=p[0],d=p[1],v=Object(r.useState)({}),b=Object(c.a)(v,2),y=b[0],g=b[1],w=!Ln(s),O=e>5,k=function(){i(1),f(Tn(1,Object(u.a)({},Gn)))},M=Object(r.useCallback)((function(){i(0),f(Tn(e,Object(u.a)({},Gn)))}),[e]),S=Object(r.useCallback)((function(n){i(e+1),e<5&&f(Tn(e+1,n))}),[e]),L=Object(r.useCallback)((function(n){var t=Ln(s),r=n.key,a=function(n){return{ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}}[n]}(r),i="x"===r.toLowerCase(),o="z"===r.toLowerCase(),c="r"===r.toLowerCase();if(0!==e||!i&&!o)if(!O&&!w||!i&&!o){if(t){if(a&&_n(t,s,a),i)if(function(n,t){var e=G(n.position,t).find((function(n){return"weapon"===n.type}));return!!e&&(n.weapon=e,Object($.remove)(t,(function(n){return n.id===e.id})),!0)}(t,s));else if(function(n,t){var e=G(n.position,t).find((function(n){return">"===n.char}));return Boolean(e)}(t,s)){t.actions.push({type:"change-level",value:1,cost:0})}else{if(s.filter((function(n){return"b"===n.char&&"@"===n.owner.char})).length<t.weapon.capacity){var u=t.weapon.use(t);t.actions.push(u)}}if(a||o||i){var l=function(n){for(var t={},e=Ln(n),r=n.filter((function(n){return n.id!==e.id})),a=0,i=[e].concat(Object(F.a)(r));a<i.length;a++){var o=i[a];$n(o,n,t)}var c=!0,u=!1,l=void 0;try{for(var s,f=n[Symbol.iterator]();!(c=(s=f.next()).done);c=!0){var h=s.value;h.armour&&h.armour.defense<=0&&(h.armour=null),h.health<=0&&(h.alive=!1)}}catch(m){u=!0,l=m}finally{try{c||null==f.return||f.return()}finally{if(u)throw l}}var p=n.filter((function(n){return n.alive}));return Zn++,{newEntities:p,newEvents:t}}(s),h=l.newEntities,p=l.newEvents;f(h),d(p),p.changeLevel&&S(t)}c&&k()}}else M();else k()}),[s,S,M,e,w,O]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",L),function(){window.removeEventListener("keydown",L)}}),[L]),a.a.createElement(x,{win:O,lose:w},0===e?a.a.createElement(E,null,a.a.createElement("h1",null,"bomblike"),a.a.createElement("button",{onClick:k},"play ",a.a.createElement("span",{className:"key"},"(x)"))):a.a.createElement(j,{className:"map-container",shake:!0===m.shake},O?a.a.createElement(Kn,null):a.a.createElement(B,{entities:s.filter((function(n){return n.visible})),hoverStart:function(n){g(n)},hoverEnd:function(){g(null)}}),a.a.createElement(Wn,{entities:s,hovered:y,win:O,lose:w,events:m})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(Qn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.cedff7ef.chunk.js.map